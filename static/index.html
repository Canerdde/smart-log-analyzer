<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Log Analyzer</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <style>
        :root {
            /* Light theme colors - Modern & Professional */
            --bg-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --bg-secondary: #fafbfc;
            --bg-tertiary: #f0f2f5;
            --text-primary: #1a1d29;
            --text-secondary: #6b7280;
            --text-inverse: white;
            --border-color: #e5e7eb;
            --shadow: rgba(0,0,0,0.08);
            --card-bg: #ffffff;
            --input-bg: #ffffff;
            --error-bg: #fef2f2;
            --error-text: #dc2626;
            --success-bg: #f0fdf4;
            --success-text: #16a34a;
            --accent-color: #667eea;
            --accent-hover: #5568d3;
        }

        [data-theme="dark"] {
            /* Dark theme colors */
            --bg-primary: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            --bg-secondary: #1e1e2e;
            --bg-tertiary: #2d2d44;
            --text-primary: #e0e0e0;
            --text-secondary: #b0b0b0;
            --text-inverse: #e0e0e0;
            --border-color: #667eea;
            --shadow: rgba(0,0,0,0.5);
            --card-bg: #252538;
            --input-bg: #2d2d44;
            --error-bg: #4a1f1f;
            --error-text: #ff6b6b;
            --success-bg: #1f4a1f;
            --success-text: #6bff6b;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            background: var(--bg-secondary);
            min-height: 100vh;
            padding: 0;
            color: var(--text-primary);
            transition: background 0.3s ease, color 0.3s ease;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: var(--bg-secondary);
            min-height: 100vh;
            transition: background 0.3s ease;
            overflow: visible;
        }
        
        .main-nav {
            position: sticky;
            top: 0;
            z-index: 100;
            background: var(--card-bg);
            border-bottom: 2px solid var(--border-color);
            padding: 12px 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            display: block;
            width: 100%;
        }
        
        .nav-tabs {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            list-style: none;
            margin: 0;
            padding: 0;
        }
        
        .nav-tab {
            padding: 14px 20px;
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            color: var(--text-secondary);
            font-size: 15px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
            position: relative;
            display: inline-block;
            min-width: auto;
        }
        
        .nav-tab:hover {
            color: var(--text-primary);
            background: var(--bg-tertiary);
        }
        
        .nav-tab.active {
            color: var(--accent-color);
            border-bottom-color: var(--accent-color);
            background: transparent;
        }
        
        .nav-tab .badge {
            display: inline-block;
            background: var(--accent-color);
            color: white;
            font-size: 11px;
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: 6px;
        }
        
        .content-section {
            display: none;
            padding: 24px 30px;
            animation: fadeIn 0.3s ease;
        }
        
        .content-section.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .section-header h2 {
            font-size: 1.5em;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
        }

        header {
            background: var(--bg-primary);
            color: var(--text-inverse);
            padding: 24px 30px;
            text-align: center;
            position: relative;
        }

        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 8px 15px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 20px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            box-sizing: border-box;
            margin: 0;
            vertical-align: middle;
            line-height: 1.2;
        }

        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        header h1 {
            font-size: 2.2em;
            margin-bottom: 8px;
            font-weight: 700;
            letter-spacing: -0.5px;
        }
        
        header p {
            font-size: 0.95em;
            opacity: 0.9;
            font-weight: 300;
        }

        .content {
            padding: 0;
            background: var(--bg-secondary);
            transition: background 0.3s ease;
        }
        
        .section-title {
            font-size: 1.4em;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--bg-tertiary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .upload-section {
            background: var(--card-bg);
            padding: 20px 24px;
            border-radius: 12px;
            margin-bottom: 16px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        
        .upload-section:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .upload-section h2 {
            margin-bottom: 16px;
            color: var(--text-primary);
            font-size: 1.2em;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-icon {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .collapsible-section {
            cursor: pointer;
            user-select: none;
        }
        
        .collapsible-section::after {
            content: 'â–¼';
            float: right;
            transition: transform 0.3s;
            font-size: 0.8em;
            color: var(--text-secondary);
        }
        
        .collapsible-section.collapsed::after {
            transform: rotate(-90deg);
        }
        
        .section-content {
            overflow: visible;
            transition: max-height 0.3s ease;
        }
        
        .section-content.collapsed {
            max-height: 0;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }

        .file-input-wrapper {
            position: relative;
            display: inline-block;
            width: 100%;
        }

        .file-input-wrapper input[type=file] {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-input-label {
            display: block;
            padding: 20px;
            background: var(--input-bg);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            color: var(--text-primary);
        }
        
        .file-input-label.drag-over {
            background: var(--accent-color);
            border-color: var(--accent-color);
            color: white;
            transform: scale(1.02);
        }
        
        .file-input-label.drag-over::before {
            content: 'ğŸ“¥ ';
        }

        .file-input-label.highlight {
            border-color: var(--accent-color);
            background: var(--bg-tertiary);
            transform: scale(1.02);
        }

        .file-input-label:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .checkbox-wrapper {
            margin: 15px 0;
        }

        .checkbox-wrapper label {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }

        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 15px;
            transition: all 0.3s;
        }

        button:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: var(--card-bg);
            color: var(--text-primary);
            padding: 20px 24px;
            border-radius: 12px;
            text-align: left;
            border: 1px solid var(--bg-tertiary);
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .stat-card h3 {
            font-size: 2em;
            margin-bottom: 8px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .stat-card p {
            font-size: 0.9em;
            color: var(--text-secondary);
            font-weight: 500;
            margin: 0;
        }
        
        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .files-list {
            margin-top: 30px;
            overflow: visible;
        }

        .file-item {
            background: var(--card-bg);
            padding: 18px 20px;
            border-radius: 12px;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
            border: 1px solid var(--bg-tertiary);
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
            position: relative;
            overflow: visible;
            z-index: 1;
        }

        .file-item:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transform: translateY(-2px);
            border-color: var(--border-color);
            z-index: 2;
        }

        .file-info h3 {
            color: var(--text-primary);
            margin-bottom: 6px;
            font-size: 1.05em;
            font-weight: 600;
        }

        .file-info p {
            color: var(--text-secondary);
            font-size: 0.85em;
            margin: 0;
        }

        .file-actions {
            display: flex;
            gap: 8px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .file-actions button {
            padding: 8px 16px;
            font-size: 13px;
            border-radius: 6px;
            font-weight: 500;
            transition: all 0.2s;
        }
        
        .file-actions button:hover {
            transform: translateY(-1px);
        }
        
        .btn-danger {
            background: #dc3545;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .btn-info {
            background: #17a2b8;
        }

        .btn-info:hover {
            background: #138496;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .loading.active {
            display: block;
        }

        .draggable-widget {
            cursor: move;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .draggable-widget.dragging {
            opacity: 0.5;
            transform: scale(0.95);
            box-shadow: 0 8px 16px var(--shadow);
        }
        
        .draggable-widget.drag-over {
            border: 2px dashed var(--accent-color);
        }
        
        .widget-customization-mode .draggable-widget {
            border: 2px solid var(--border-color);
        }
        
        .widget-hidden {
            display: none !important;
        }
        
        .chart-container {
            margin: 20px 0;
            padding: 20px;
            background: var(--card-bg);
            border-radius: 12px;
            transition: background 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border: 1px solid var(--bg-tertiary);
        }
        
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .chart-container canvas {
            max-height: 300px !important;
        }
        
        .chart-container h3 {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .error {
            background: var(--error-bg);
            color: var(--error-text);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            transition: background 0.3s ease, color 0.3s ease;
        }

        .success {
            background: var(--success-bg);
            color: var(--success-text);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            transition: background 0.3s ease, color 0.3s ease;
        }

        .files-list h2 {
            color: var(--text-primary);
            margin-bottom: 20px;
        }
        
        /* Responsive Design - Mobile & Tablet */
        @media (max-width: 768px) {
            /* Tablet */
            .container {
                max-width: 100%;
            }
            
            header {
                padding: 20px 15px;
            }
            
            header h1 {
                font-size: 1.8em;
            }
            
            .theme-toggle {
                top: 15px;
                right: 15px;
                padding: 8px 12px;
                font-size: 18px;
            }
            
            .main-nav {
                padding: 10px 15px;
            }
            
            .nav-tabs {
                gap: 4px;
            }
            
            .nav-tab {
                padding: 10px 12px;
                font-size: 13px;
            }
            
            .content-section {
                padding: 16px 15px;
            }
            
            .section-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .section-header h2 {
                font-size: 1.3em;
            }
            
            .upload-section {
                padding: 15px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 12px;
            }
            
            .stat-card {
                padding: 15px;
            }
            
            .stat-card h3 {
                font-size: 1.6em;
            }
            
            .file-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }
            
            .file-actions {
                width: 100%;
                flex-wrap: wrap;
                justify-content: flex-start;
            }
            
            .file-actions button {
                flex: 1;
                min-width: 80px;
            }
            
            .charts-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .chart-container {
                padding: 15px;
            }
            
            #streamControls {
                display: flex;
                flex-direction: column;
                gap: 10px;
            }
            
            #streamControls select,
            #streamControls input,
            #streamControls button {
                width: 100%;
                margin: 0 !important;
            }
            
            #streamLogs {
                max-height: 400px;
                font-size: 11px;
                padding: 10px;
            }
            
            .log-entry {
                padding: 6px 8px !important;
                font-size: 11px !important;
            }
            
            .log-entry > div {
                flex-wrap: wrap;
                gap: 5px !important;
            }
            
            .log-entry span {
                min-width: auto !important;
            }
            
            /* Modals */
            [id$="Modal"] > div {
                width: 95% !important;
                padding: 20px !important;
                margin: 10px auto !important;
            }
            
            /* Comparison section */
            #comparison-section .upload-section > div {
                flex-direction: column;
            }
            
            #comparison-section select,
            #comparison-section button {
                width: 100%;
                margin: 5px 0;
            }
        }
        
        @media (max-width: 480px) {
            /* Mobile */
            header h1 {
                font-size: 1.5em;
                padding-right: 50px;
            }
            
            header p {
                font-size: 0.85em;
            }
            
            #authButtons {
                right: 60px !important;
                gap: 5px !important;
                flex-wrap: wrap;
            }
            
            #authButtons button {
                padding: 6px 10px !important;
                font-size: 11px !important;
            }
            
            #userInfo {
                right: 60px !important;
                gap: 5px !important;
                flex-wrap: wrap;
            }
            
            #userInfo button {
                padding: 6px 10px !important;
                font-size: 11px !important;
            }
            
            #userName {
                padding: 6px 10px !important;
                font-size: 11px !important;
            }
            
            .theme-toggle {
                top: 15px !important;
                right: 15px !important;
                padding: 8px 12px !important;
                font-size: 16px !important;
            }
            
            .nav-tab {
                padding: 8px 10px;
                font-size: 12px;
            }
            
            .nav-tab span {
                display: none;
            }
            
            .nav-tab::before {
                content: attr(data-icon);
                font-size: 16px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .stat-card h3 {
                font-size: 1.8em;
            }
            
            .file-actions {
                flex-direction: column;
            }
            
            .file-actions button {
                width: 100%;
            }
            
            .upload-section h2 {
                font-size: 1.1em;
            }
            
            .file-input-label {
                padding: 15px;
                font-size: 14px;
            }
            
            button {
                padding: 10px 20px;
                font-size: 14px;
            }
            
            #streamLogs {
                max-height: 300px;
                font-size: 10px;
            }
            
            .log-entry {
                padding: 5px 6px !important;
                font-size: 10px !important;
            }
            
            .section-header {
                margin-bottom: 15px;
            }
            
            .section-header button {
                width: 100%;
                margin-top: 10px;
            }
        }
        
        @media (min-width: 769px) and (max-width: 1024px) {
            /* Tablet Landscape */
            .charts-grid {
                grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            }
            
            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            }
        }
        
        /* Print styles */
        @media print {
            .main-nav,
            .theme-toggle,
            button,
            .file-actions {
                display: none !important;
            }
            
            .content-section {
                display: block !important;
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div id="authButtons" style="position: absolute; top: 20px; right: 80px; display: flex; gap: 10px; z-index: 10; align-items: center; height: 40px;">
                <button onclick="showLoginModal()" id="loginBtn" style="padding: 8px 16px; background: rgba(255, 255, 255, 0.2); color: white; border: 2px solid rgba(255, 255, 255, 0.3); border-radius: 25px; cursor: pointer; font-size: 14px; backdrop-filter: blur(10px); transition: all 0.3s ease; height: 40px; display: flex; align-items: center; line-height: 1;" onmouseover="this.style.background='rgba(255, 255, 255, 0.3)';" onmouseout="this.style.background='rgba(255, 255, 255, 0.2)';">ğŸ” GiriÅŸ Yap</button>
                <button onclick="showRegisterModal()" id="registerBtn" style="padding: 8px 16px; background: rgba(255, 255, 255, 0.2); color: white; border: 2px solid rgba(255, 255, 255, 0.3); border-radius: 25px; cursor: pointer; font-size: 14px; backdrop-filter: blur(10px); transition: all 0.3s ease; height: 40px; display: flex; align-items: center; line-height: 1;" onmouseover="this.style.background='rgba(255, 255, 255, 0.3)';" onmouseout="this.style.background='rgba(255, 255, 255, 0.2)';">ğŸ“ KayÄ±t Ol</button>
            </div>
            <div id="userInfo" style="position: absolute; top: 20px; right: 80px; display: none; align-items: center; gap: 10px; z-index: 10;">
                <span id="userName" style="color: white; font-weight: 500; font-size: 14px; background: rgba(255, 255, 255, 0.2); padding: 8px 16px; border-radius: 25px; backdrop-filter: blur(10px); border: 2px solid rgba(255, 255, 255, 0.3); display: inline-flex; align-items: center; line-height: 1.2; white-space: nowrap; box-sizing: border-box; margin: 0; vertical-align: middle;"></span>
                <button onclick="showProfileModal()" style="padding: 8px 16px; background: rgba(255, 255, 255, 0.2); color: white; border: 2px solid rgba(255, 255, 255, 0.3); border-radius: 25px; cursor: pointer; font-size: 14px; font-weight: 500; backdrop-filter: blur(10px); transition: all 0.3s ease; display: inline-flex; align-items: center; line-height: 1.2; box-sizing: border-box; margin: 0; vertical-align: middle;" onmouseover="this.style.background='rgba(255, 255, 255, 0.3)';" onmouseout="this.style.background='rgba(255, 255, 255, 0.2)';">ğŸ‘¤ Profil</button>
                <button onclick="logout()" style="padding: 8px 16px; background: rgba(255, 255, 255, 0.2); color: white; border: 2px solid rgba(255, 255, 255, 0.3); border-radius: 25px; cursor: pointer; font-size: 14px; font-weight: 500; backdrop-filter: blur(10px); transition: all 0.3s ease; display: inline-flex; align-items: center; line-height: 1.2; box-sizing: border-box; margin: 0; vertical-align: middle;" onmouseover="this.style.background='rgba(255, 255, 255, 0.3)';" onmouseout="this.style.background='rgba(255, 255, 255, 0.2)';">ğŸšª Ã‡Ä±kÄ±ÅŸ</button>
            </div>
            <button class="theme-toggle" onclick="toggleTheme()" title="Tema DeÄŸiÅŸtir">
                <span id="themeIcon">ğŸŒ™</span>
            </button>
            <h1>ğŸ” Smart Log Analyzer</h1>
            <p>AkÄ±llÄ± log analiz ve izleme sistemi</p>
        </header>

        <div class="main-nav">
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="showSection('dashboard')">
                    ğŸ“Š Dashboard
                </button>
                <button class="nav-tab" onclick="showSection('files')">
                    ğŸ“ Dosyalar
                </button>
                <button class="nav-tab" onclick="showSection('streaming')">
                    ğŸ“¡ CanlÄ± Ä°zleme
                </button>
                <button class="nav-tab" onclick="showSection('saved-searches')">
                    ğŸ”– KayÄ±tlÄ± Aramalar
                </button>
                <button class="nav-tab" onclick="showSection('favorites')">
                    â­ Favoriler
                </button>
                <button class="nav-tab" onclick="showSection('alerts')">
                    ğŸš¨ Alertler
                </button>
                <button class="nav-tab" onclick="showSection('comparison')">
                    ğŸ“Š KarÅŸÄ±laÅŸtÄ±rma
                </button>
            </div>
        </div>

        <div class="content">
            <!-- Dashboard Section -->
            <div id="dashboard-section" class="content-section active">
                <div class="section-header">
                    <h2>Dashboard</h2>
                </div>
                
                <!-- Upload Section -->
                <div class="upload-section">
                    <h2 class="collapsible-section" onclick="toggleSection(this)">ğŸ“¤ Log DosyasÄ± YÃ¼kle</h2>
                    <div class="section-content">
                        <div class="file-input-wrapper">
                            <input type="file" id="fileInput" accept=".log,.txt" multiple>
                            <label for="fileInput" class="file-input-label" id="dropArea">
                                ğŸ“ Dosya SeÃ§ veya SÃ¼rÃ¼kle-BÄ±rak (Ã‡oklu dosya desteklenir)
                            </label>
                            <div id="dragDropInfo" style="margin-top: 10px; padding: 10px; background: var(--bg-tertiary); border-radius: 5px; font-size: 12px; color: var(--text-secondary); display: none;">
                                <strong>SeÃ§ilen dosyalar:</strong> <span id="selectedFilesCount">0</span>
                            </div>
                        </div>
                        <div class="checkbox-wrapper">
                            <label>
                                <input type="checkbox" id="useAI">
                                <span>AI ile analiz yap (OpenAI API gerekli)</span>
                            </label>
                        </div>
                        <button onclick="uploadFile()">YÃ¼kle ve Analiz Et</button>
                        <div id="uploadStatus"></div>
                    </div>
                </div>

                <!-- Dashboard Stats -->
                <div id="dashboardStats" class="stats-grid"></div>

                <!-- Charts -->
                <div style="margin-bottom: 20px;">
                    <button onclick="toggleWidgetCustomization()" style="padding: 8px 15px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 13px; margin-bottom: 10px;">âš™ï¸ Widget DÃ¼zenle</button>
                </div>
                <div class="charts-grid" id="chartsGrid" style="display: none;">
                    <div class="chart-container draggable-widget" data-widget-id="levelChart" draggable="true">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <h3 style="margin: 0;"><span class="section-icon">ğŸ“Š</span> Log Seviyesi DaÄŸÄ±lÄ±mÄ±</h3>
                            <button onclick="toggleWidget('levelChart')" class="widget-toggle" style="background: transparent; border: none; cursor: pointer; font-size: 16px; color: var(--text-secondary);" title="Gizle/GÃ¶ster">ğŸ‘ï¸</button>
                        </div>
                        <canvas id="levelChart"></canvas>
                    </div>
                    <div class="chart-container draggable-widget" data-widget-id="timeChart" draggable="true">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <h3 style="margin: 0;"><span class="section-icon">â°</span> Saatlere GÃ¶re Log DaÄŸÄ±lÄ±mÄ±</h3>
                            <button onclick="toggleWidget('timeChart')" class="widget-toggle" style="background: transparent; border: none; cursor: pointer; font-size: 16px; color: var(--text-secondary);" title="Gizle/GÃ¶ster">ğŸ‘ï¸</button>
                        </div>
                        <canvas id="timeChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Files Section -->
            <div id="files-section" class="content-section">
                <div class="section-header">
                    <h2>YÃ¼klenen Dosyalar</h2>
                </div>
                <!-- Bulk Actions Toolbar -->
                <div id="bulkActionsToolbar" style="display: none; background: var(--card-bg); padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 2px solid var(--accent-color);">
                    <div style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap;">
                        <span style="color: var(--text-primary); font-weight: 600;">
                            <span id="selectedCount">0</span> dosya seÃ§ildi
                        </span>
                        <button onclick="selectAllFiles()" style="padding: 8px 15px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 13px;">TÃ¼mÃ¼nÃ¼ SeÃ§</button>
                        <button onclick="deselectAllFiles()" style="padding: 8px 15px; background: var(--bg-tertiary); color: var(--text-primary); border: none; border-radius: 5px; cursor: pointer; font-size: 13px;">SeÃ§imi KaldÄ±r</button>
                        <div style="flex: 1;"></div>
                        <button onclick="bulkDeleteFiles()" style="padding: 8px 15px; background: #dc3545; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 13px; font-weight: 500;">ğŸ—‘ï¸ Toplu Sil</button>
                        <button onclick="bulkExportFiles()" style="padding: 8px 15px; background: #28a745; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 13px; font-weight: 500;">ğŸ“¥ Toplu Export</button>
                        <button onclick="bulkFavoriteFiles('add')" style="padding: 8px 15px; background: #ffc107; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 13px; font-weight: 500;">â­ Favorilere Ekle</button>
                        <button onclick="bulkFavoriteFiles('remove')" style="padding: 8px 15px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 13px; font-weight: 500;">â˜† Favorilerden Ã‡Ä±kar</button>
                    </div>
                </div>
                <!-- Tag Filter -->
                <div style="margin-bottom: 15px; margin-top: -5px; display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                    <label style="color: var(--text-primary); font-weight: 500; display: flex; align-items: center; height: 38px;">Etiket Filtresi:</label>
                    <select id="tagFilter" onchange="loadFiles()" style="padding: 8px 12px; border: 2px solid var(--border-color); border-radius: 5px; background: var(--input-bg); color: var(--text-primary); min-width: 200px; height: 38px; box-sizing: border-box;">
                        <option value="">TÃ¼m Etiketler</option>
                    </select>
                    <label style="color: var(--text-primary); font-weight: 500; margin-left: 15px; display: flex; align-items: center; height: 38px;">Kategori:</label>
                    <select id="categoryFilter" onchange="loadFiles()" style="padding: 8px 12px; border: 2px solid var(--border-color); border-radius: 5px; background: var(--input-bg); color: var(--text-primary); min-width: 200px; height: 38px; box-sizing: border-box;">
                        <option value="">TÃ¼m Kategoriler</option>
                    </select>
                    <button onclick="showTagManagementModal()" style="padding: 8px 15px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 13px; height: 38px; display: flex; align-items: center; box-sizing: border-box; margin: 0;">ğŸ·ï¸ Etiket YÃ¶netimi</button>
                    <button onclick="showCategoryManagementModal()" style="padding: 8px 15px; background: #17a2b8; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 13px; height: 38px; display: flex; align-items: center; box-sizing: border-box; margin: 0;">ğŸ“ Kategori YÃ¶netimi</button>
                </div>
                <div id="filesList"></div>
            </div>

            <!-- Streaming Section -->
            <div id="streaming-section" class="content-section">
                <div class="section-header">
                    <h2>CanlÄ± Log Ä°zleme</h2>
                </div>
                <div class="upload-section">
                    <div id="streamControls" style="margin-bottom: 15px;">
                        <select id="streamFileSelect" style="margin: 10px; padding: 8px; width: 300px; border: 2px solid var(--border-color); border-radius: 5px; background: var(--input-bg); color: var(--text-primary);">
                            <option value="">Dosya SeÃ§in</option>
                        </select>
                        <select id="streamLevelFilter" style="margin: 10px; padding: 8px; border: 2px solid var(--border-color); border-radius: 5px; background: var(--input-bg); color: var(--text-primary);">
                            <option value="">TÃ¼m Seviyeler</option>
                            <option value="ERROR">Sadece Hatalar</option>
                            <option value="WARNING">Sadece UyarÄ±lar</option>
                            <option value="INFO">Sadece Bilgiler</option>
                        </select>
                        <div style="position: relative; display: inline-block; margin: 10px;">
                            <input type="text" id="streamSearch" placeholder="Ara..." style="padding: 8px 35px 8px 8px; width: 200px; border: 2px solid var(--border-color); border-radius: 5px; background: var(--input-bg); color: var(--text-primary);" onkeyup="loadSearchHistory()" onfocus="loadSearchHistory()">
                            <button onclick="toggleSearchHistoryDropdown()" style="position: absolute; right: 5px; top: 50%; transform: translateY(-50%); background: transparent; border: none; cursor: pointer; color: var(--text-secondary); font-size: 16px; padding: 4px 8px;" title="Arama GeÃ§miÅŸi">ğŸ“œ</button>
                            <div id="searchHistoryDropdown" style="display: none; position: absolute; top: 100%; left: 0; right: 0; background: var(--card-bg); border: 1px solid var(--border-color); border-radius: 6px; box-shadow: 0 4px 12px var(--shadow); z-index: 1000; max-height: 300px; overflow-y: auto; margin-top: 5px;">
                                <div style="padding: 10px; border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center;">
                                    <strong style="color: var(--text-primary); font-size: 12px;">Arama GeÃ§miÅŸi</strong>
                                    <button onclick="clearSearchHistory()" style="background: transparent; border: none; color: var(--error-text); cursor: pointer; font-size: 11px; padding: 2px 6px;" title="Temizle">Temizle</button>
                                </div>
                                <div id="searchHistoryList" style="max-height: 250px; overflow-y: auto;">
                                    <!-- Arama geÃ§miÅŸi buraya eklenecek -->
                                </div>
                            </div>
                        </div>
                        <button onclick="startStreaming()" id="startStreamBtn" style="margin: 10px;">â–¶ï¸ Streaming BaÅŸlat</button>
                        <button onclick="stopStreaming()" id="stopStreamBtn" style="display: none; margin: 10px;">â¹ï¸ Durdur</button>
                        <button onclick="showSaveSearchModal()" style="margin: 10px; background: #28a745;">ğŸ”– AramayÄ± Kaydet</button>
                    </div>
                    <div id="streamStatus" style="margin: 10px 0; padding: 10px; background: var(--bg-tertiary); border-radius: 5px; color: var(--text-secondary);">
                        BaÄŸlantÄ± bekleniyor...
                    </div>
                    <div id="streamLogs" style="max-height: 500px; overflow-y: auto; background: var(--card-bg); padding: 15px; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 12px; border: 1px solid var(--border-color);">
                        <!-- Log entries buraya eklenecek -->
                    </div>
                </div>
            </div>

            <!-- Saved Searches Section -->
            <div id="saved-searches-section" class="content-section">
                <div class="section-header">
                    <h2>KayÄ±tlÄ± Aramalar</h2>
                </div>
                <div id="savedSearchesList" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px;">
                    <!-- Saved searches buraya eklenecek -->
                </div>
                <div id="savedSearchesEmpty" style="text-align: center; padding: 40px; color: var(--text-secondary); display: none;">
                    <p style="font-size: 1.1em; margin-bottom: 10px;">HenÃ¼z kayÄ±tlÄ± arama yok</p>
                    <p style="font-size: 0.9em; opacity: 0.8;">Bir arama yapÄ±p kaydedebilirsiniz</p>
                </div>
            </div>

            <!-- Favorites Section -->
            <div id="favorites-section" class="content-section">
                <div class="section-header">
                    <h2>Favoriler</h2>
                </div>
                <div id="favoritesList" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px;">
                    <!-- Favorites buraya eklenecek -->
                </div>
                <div id="favoritesEmpty" style="text-align: center; padding: 40px; color: var(--text-secondary); display: none;">
                    <p style="font-size: 1.1em; margin-bottom: 10px;">HenÃ¼z favori dosya yok</p>
                    <p style="font-size: 0.9em; opacity: 0.8;">DosyalarÄ±n yanÄ±ndaki â­ butonuna tÄ±klayarak favorilere ekleyebilirsiniz</p>
                </div>
            </div>

            <!-- Alerts Section -->
            <div id="alerts-section" class="content-section">
                <div class="section-header">
                    <h2>Alert KurallarÄ±</h2>
                    <button onclick="showCreateAlertModal()" style="padding: 10px 20px; background: #dc3545; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 500;">+ Yeni Alert</button>
                </div>
                <div id="alertsList" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px;">
                    <!-- Alerts buraya eklenecek -->
                </div>
                <div id="alertsEmpty" style="text-align: center; padding: 40px; color: var(--text-secondary); display: none;">
                    <p style="font-size: 1.1em; margin-bottom: 10px;">HenÃ¼z alert kuralÄ± yok</p>
                    <p style="font-size: 0.9em; opacity: 0.8;">Kritik hatalar iÃ§in bildirim kurallarÄ± oluÅŸturabilirsiniz</p>
                </div>
            </div>

            <!-- Comparison Section -->
            <div id="comparison-section" class="content-section">
                <div class="section-header">
                    <h2>Log KarÅŸÄ±laÅŸtÄ±rma</h2>
                </div>
                <div class="upload-section">
                    <div style="display: flex; gap: 15px; margin-bottom: 20px; flex-wrap: wrap;">
                        <select id="compareFile1" style="flex: 1; min-width: 200px; padding: 10px; border: 2px solid var(--border-color); border-radius: 6px; background: var(--input-bg); color: var(--text-primary);">
                            <option value="">Ä°lk DosyayÄ± SeÃ§in</option>
                        </select>
                        <select id="compareFile2" style="flex: 1; min-width: 200px; padding: 10px; border: 2px solid var(--border-color); border-radius: 6px; background: var(--input-bg); color: var(--text-primary);">
                            <option value="">Ä°kinci DosyayÄ± SeÃ§in</option>
                        </select>
                        <button onclick="compareLogs()" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 500;">KarÅŸÄ±laÅŸtÄ±r</button>
                    </div>
                    <div id="comparisonResults" style="display: none; margin-top: 20px;">
                        <!-- Comparison results buraya eklenecek -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Save Search Modal -->
    <div id="saveSearchModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; justify-content: center; align-items: center; backdrop-filter: blur(3px);" onclick="if(event.target === this) closeSaveSearchModal();">
        <div style="background: var(--card-bg); padding: 30px; border-radius: 15px; max-width: 500px; width: 90%; box-shadow: 0 10px 40px var(--shadow); animation: modalSlideIn 0.3s ease; position: relative;" onclick="event.stopPropagation();">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 style="color: var(--text-primary); margin: 0;">ğŸ”– AramayÄ± Kaydet</h2>
                <button onclick="closeSaveSearchModal()" style="background: transparent; border: none; font-size: 24px; cursor: pointer; color: var(--text-secondary); transition: transform 0.2s;" onmouseover="this.style.transform='rotate(90deg)';" onmouseout="this.style.transform='rotate(0deg)';">âœ•</button>
            </div>
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px; color: var(--text-primary); font-weight: bold;">Arama AdÄ± *</label>
                <input type="text" id="saveSearchName" placeholder="Ã–rn: Database HatalarÄ±" 
                       style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 5px; background: var(--input-bg); color: var(--text-primary); font-size: 14px;">
            </div>
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 5px; color: var(--text-primary); font-weight: bold;">AÃ§Ä±klama (Opsiyonel)</label>
                <textarea id="saveSearchDescription" placeholder="Bu arama hakkÄ±nda not..." 
                          style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 5px; background: var(--input-bg); color: var(--text-primary); font-size: 14px; min-height: 80px; resize: vertical;"></textarea>
            </div>
            <div style="display: flex; gap: 10px; justify-content: flex-end;">
                <button onclick="closeSaveSearchModal()" style="padding: 10px 20px; background: var(--bg-tertiary); color: var(--text-primary); border: none; border-radius: 5px; cursor: pointer; transition: all 0.3s;" onmouseover="this.style.background='var(--border-color)';" onmouseout="this.style.background='var(--bg-tertiary)';">Ä°ptal</button>
                <button onclick="saveCurrentSearch()" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; transition: all 0.3s;" onmouseover="this.style.background='#5568d3'; this.style.transform='translateY(-2px)';" onmouseout="this.style.background='#667eea'; this.style.transform='translateY(0)';">Kaydet</button>
            </div>
        </div>
    </div>

    <!-- Create Alert Modal -->
    <div id="createAlertModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 10002; backdrop-filter: blur(5px); overflow-y: auto; padding: 20px;" onclick="if(event.target === this) closeCreateAlertModal();">
        <div style="background: var(--card-bg); padding: 25px; border-radius: 15px; max-width: 650px; width: 90%; box-shadow: 0 10px 40px var(--shadow); animation: modalSlideIn 0.3s ease; position: relative; margin: 20px auto; max-height: calc(100vh - 40px); overflow-y: auto;" onclick="event.stopPropagation();">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; border-bottom: 2px solid var(--bg-tertiary); padding-bottom: 15px;">
                <h2 style="color: var(--text-primary); margin: 0; font-size: 24px; display: flex; align-items: center; gap: 10px;">
                    <span style="font-size: 32px;">ğŸš¨</span>
                    <span>Yeni Alert KuralÄ±</span>
                </h2>
                <button onclick="closeCreateAlertModal()" style="background: transparent; border: none; font-size: 28px; cursor: pointer; color: var(--text-secondary); transition: transform 0.2s; width: 35px; height: 35px; display: flex; align-items: center; justify-content: center; border-radius: 50%;" onmouseover="this.style.transform='rotate(90deg)'; this.style.background='var(--bg-tertiary)';" onmouseout="this.style.transform='rotate(0deg)'; this.style.background='transparent';">âœ•</button>
            </div>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; color: var(--text-primary); font-weight: bold; font-size: 14px;">
                    Alert AdÄ± <span style="color: var(--error-text);">*</span>
                </label>
                <input type="text" id="alertName" placeholder="Ã–rn: Kritik Hata Bildirimi" 
                       style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; background: var(--input-bg); color: var(--text-primary); font-size: 14px; transition: border-color 0.3s;"
                       onfocus="this.style.borderColor='#667eea';" onblur="this.style.borderColor='var(--border-color)';">
            </div>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; color: var(--text-primary); font-weight: bold; font-size: 14px;">
                    AÃ§Ä±klama
                </label>
                <textarea id="alertDescription" placeholder="Bu alert kuralÄ± hakkÄ±nda aÃ§Ä±klama..." 
                          style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; background: var(--input-bg); color: var(--text-primary); font-size: 14px; min-height: 80px; resize: vertical; transition: border-color 0.3s; font-family: inherit;"
                          onfocus="this.style.borderColor='#667eea';" onblur="this.style.borderColor='var(--border-color)';"></textarea>
            </div>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; color: var(--text-primary); font-weight: bold; font-size: 14px;">
                    KoÅŸul Tipi <span style="color: var(--error-text);">*</span>
                </label>
                <select id="alertConditionType" 
                        style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; background: var(--input-bg); color: var(--text-primary); font-size: 14px; cursor: pointer; transition: border-color 0.3s;"
                        onfocus="this.style.borderColor='#667eea';" onblur="this.style.borderColor='var(--border-color)';"
                        onchange="updateAlertConditionFields()">
                    <option value="">SeÃ§iniz...</option>
                    <option value="error_count">Hata SayÄ±sÄ± (error_count)</option>
                    <option value="pattern_match">Pattern EÅŸleÅŸmesi (pattern_match)</option>
                    <option value="threshold">Genel EÅŸik (threshold)</option>
                </select>
                <small style="color: var(--text-secondary); font-size: 12px; margin-top: 5px; display: block;">
                    <strong>error_count:</strong> Belirli bir zaman diliminde hata sayÄ±sÄ± kontrolÃ¼<br>
                    <strong>pattern_match:</strong> Belirli bir pattern'in eÅŸleÅŸmesi<br>
                    <strong>threshold:</strong> Genel log sayÄ±sÄ± eÅŸik kontrolÃ¼
                </small>
            </div>
            
            <div id="alertConditionFields" style="margin-bottom: 20px; display: none;">
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; color: var(--text-primary); font-weight: bold; font-size: 14px;">
                        Threshold (EÅŸik DeÄŸeri) <span style="color: var(--error-text);">*</span>
                    </label>
                    <input type="number" id="alertThreshold" placeholder="Ã–rn: 10" min="1"
                           style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; background: var(--input-bg); color: var(--text-primary); font-size: 14px; transition: border-color 0.3s;"
                           onfocus="this.style.borderColor='#667eea';" onblur="this.style.borderColor='var(--border-color)';">
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; color: var(--text-primary); font-weight: bold; font-size: 14px;">
                        Zaman Penceresi (saniye)
                    </label>
                    <input type="number" id="alertTimeWindow" placeholder="Ã–rn: 300 (5 dakika)" min="60" value="300"
                           style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; background: var(--input-bg); color: var(--text-primary); font-size: 14px; transition: border-color 0.3s;"
                           onfocus="this.style.borderColor='#667eea';" onblur="this.style.borderColor='var(--border-color)';">
                    <small style="color: var(--text-secondary); font-size: 12px; margin-top: 5px; display: block;">
                        Bu sÃ¼re iÃ§inde koÅŸul kontrol edilir (varsayÄ±lan: 300 saniye = 5 dakika)
                    </small>
                </div>
                
                <div style="margin-bottom: 15px;" id="alertLogLevelField">
                    <label style="display: block; margin-bottom: 8px; color: var(--text-primary); font-weight: bold; font-size: 14px;">
                        Log Seviyesi
                    </label>
                    <select id="alertLogLevel" 
                            style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; background: var(--input-bg); color: var(--text-primary); font-size: 14px; cursor: pointer; transition: border-color 0.3s;"
                            onfocus="this.style.borderColor='#667eea';" onblur="this.style.borderColor='var(--border-color)';">
                        <option value="ERROR">ERROR</option>
                        <option value="WARNING">WARNING</option>
                        <option value="INFO">INFO</option>
                        <option value="DEBUG">DEBUG</option>
                    </select>
                </div>
                
                <div style="margin-bottom: 15px;" id="alertPatternField" style="display: none;">
                    <label style="display: block; margin-bottom: 8px; color: var(--text-primary); font-weight: bold; font-size: 14px;">
                        Pattern (Aranacak Metin)
                    </label>
                    <input type="text" id="alertPattern" placeholder="Ã–rn: database connection timeout"
                           style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; background: var(--input-bg); color: var(--text-primary); font-size: 14px; transition: border-color 0.3s;"
                           onfocus="this.style.borderColor='#667eea';" onblur="this.style.borderColor='var(--border-color)';">
                </div>
            </div>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; color: var(--text-primary); font-weight: bold; font-size: 14px;">
                    Bildirim KanallarÄ±
                </label>
                <div style="display: flex; flex-direction: column; gap: 10px;">
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer; padding: 10px; background: var(--bg-tertiary); border-radius: 8px; transition: background 0.3s;" onmouseover="this.style.background='var(--border-color)';" onmouseout="this.style.background='var(--bg-tertiary)';">
                        <input type="checkbox" id="alertChannelEmail" onchange="updateAlertChannelFields()" style="width: 18px; height: 18px; cursor: pointer;">
                        <span style="color: var(--text-primary);">ğŸ“§ Email</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer; padding: 10px; background: var(--bg-tertiary); border-radius: 8px; transition: background 0.3s;" onmouseover="this.style.background='var(--border-color)';" onmouseout="this.style.background='var(--bg-tertiary)';">
                        <input type="checkbox" id="alertChannelSlack" onchange="updateAlertChannelFields()" style="width: 18px; height: 18px; cursor: pointer;">
                        <span style="color: var(--text-primary);">ğŸ’¬ Slack</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer; padding: 10px; background: var(--bg-tertiary); border-radius: 8px; transition: background 0.3s;" onmouseover="this.style.background='var(--border-color)';" onmouseout="this.style.background='var(--bg-tertiary)';">
                        <input type="checkbox" id="alertChannelWebhook" onchange="updateAlertChannelFields()" style="width: 18px; height: 18px; cursor: pointer;">
                        <span style="color: var(--text-primary);">ğŸ”— Webhook</span>
                    </label>
                </div>
            </div>
            
            <div id="alertEmailField" style="margin-bottom: 20px; display: none;">
                <label style="display: block; margin-bottom: 8px; color: var(--text-primary); font-weight: bold; font-size: 14px;">
                    Email Adresleri
                </label>
                <input type="text" id="alertEmails" placeholder="email1@example.com, email2@example.com" 
                       style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; background: var(--input-bg); color: var(--text-primary); font-size: 14px; transition: border-color 0.3s;"
                       onfocus="this.style.borderColor='#667eea';" onblur="this.style.borderColor='var(--border-color)';">
                <small style="color: var(--text-secondary); font-size: 12px; margin-top: 5px; display: block;">
                    Birden fazla email adresini virgÃ¼lle ayÄ±rÄ±n
                </small>
            </div>
            
            <div id="alertSlackField" style="margin-bottom: 20px; display: none;">
                <label style="display: block; margin-bottom: 8px; color: var(--text-primary); font-weight: bold; font-size: 14px;">
                    Slack Webhook URL
                </label>
                <input type="text" id="alertSlackWebhook" placeholder="https://hooks.slack.com/services/..." 
                       style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; background: var(--input-bg); color: var(--text-primary); font-size: 14px; transition: border-color 0.3s;"
                       onfocus="this.style.borderColor='#667eea';" onblur="this.style.borderColor='var(--border-color)';">
            </div>
            
            <div id="alertWebhookField" style="margin-bottom: 20px; display: none;">
                <label style="display: block; margin-bottom: 8px; color: var(--text-primary); font-weight: bold; font-size: 14px;">
                    Webhook URL
                </label>
                <input type="text" id="alertWebhookUrl" placeholder="https://example.com/webhook" 
                       style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; background: var(--input-bg); color: var(--text-primary); font-size: 14px; transition: border-color 0.3s;"
                       onfocus="this.style.borderColor='#667eea';" onblur="this.style.borderColor='var(--border-color)';">
            </div>
            
            <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 25px; padding-top: 20px; border-top: 2px solid var(--bg-tertiary);">
                <button onclick="closeCreateAlertModal()" 
                        style="padding: 12px 30px; background: var(--bg-tertiary); color: var(--text-primary); border: 2px solid transparent; border-radius: 8px; cursor: pointer; font-weight: 500; transition: all 0.3s; min-width: 120px;"
                        onmouseover="this.style.background='var(--border-color)'; this.style.transform='translateY(-2px)';" 
                        onmouseout="this.style.background='var(--bg-tertiary)'; this.style.transform='translateY(0)';">
                    Ä°ptal
                </button>
                <button onclick="submitCreateAlert()" 
                        style="padding: 12px 30px; background: #dc3545; color: white; border: 2px solid #dc3545; border-radius: 8px; cursor: pointer; font-weight: bold; transition: all 0.3s; min-width: 120px;"
                        onmouseover="this.style.background='#c82333'; this.style.borderColor='#c82333'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 5px 15px rgba(220, 53, 69, 0.4)';" 
                        onmouseout="this.style.background='#dc3545'; this.style.borderColor='#dc3545'; this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                    ğŸš¨ OluÅŸtur
                </button>
            </div>
        </div>
    </div>

    <!-- Delete Saved Search Confirm Modal -->
    <div id="deleteConfirmModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 10001; justify-content: center; align-items: center; backdrop-filter: blur(5px);" onclick="if(event.target === this) closeDeleteConfirmModal();">
        <div style="background: var(--card-bg); padding: 30px; border-radius: 15px; max-width: 450px; width: 90%; box-shadow: 0 10px 40px var(--shadow); animation: modalSlideIn 0.3s ease; position: relative;" onclick="event.stopPropagation();">
            <div style="text-align: center; margin-bottom: 25px;">
                <div style="font-size: 64px; margin-bottom: 15px; animation: shake 0.5s ease;">âš ï¸</div>
                <h2 style="color: var(--text-primary); margin: 0 0 10px 0; font-size: 24px; font-weight: bold;">AramayÄ± Sil</h2>
                <p style="color: var(--text-secondary); margin: 0; line-height: 1.6; font-size: 15px;">
                    "<span id="deleteSearchName" style="font-weight: bold; color: var(--text-primary);"></span>" adlÄ± kayÄ±tlÄ± aramayÄ± silmek istediÄŸinizden emin misiniz?
                </p>
                <p style="color: var(--error-text); margin: 15px 0 0 0; font-size: 13px; font-weight: 500;">
                    âš ï¸ Bu iÅŸlem geri alÄ±namaz.
                </p>
            </div>
            <div style="display: flex; gap: 10px; justify-content: center;">
                <button onclick="closeDeleteConfirmModal()" 
                        style="padding: 12px 30px; background: var(--bg-tertiary); color: var(--text-primary); border: 2px solid transparent; border-radius: 8px; cursor: pointer; font-weight: 500; transition: all 0.3s; min-width: 120px;"
                        onmouseover="this.style.background='var(--border-color)'; this.style.transform='translateY(-2px)'; this.style.borderColor='var(--border-color)';"
                        onmouseout="this.style.background='var(--bg-tertiary)'; this.style.transform='translateY(0)'; this.style.borderColor='transparent';">
                    Ä°ptal
                </button>
                <button onclick="confirmDeleteSavedSearch()" 
                        style="padding: 12px 30px; background: #dc3545; color: white; border: 2px solid #dc3545; border-radius: 8px; cursor: pointer; font-weight: bold; transition: all 0.3s; min-width: 120px;"
                        onmouseover="this.style.background='#c82333'; this.style.borderColor='#c82333'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 5px 15px rgba(220, 53, 69, 0.4)';"
                        onmouseout="this.style.background='#dc3545'; this.style.borderColor='#dc3545'; this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                    ğŸ—‘ï¸ Sil
                </button>
            </div>
        </div>
    </div>

    <!-- Delete File Confirm Modal -->
    <div id="deleteFileConfirmModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 10003; justify-content: center; align-items: center; backdrop-filter: blur(5px);" onclick="if(event.target === this) closeDeleteFileConfirmModal();">
        <div style="background: var(--card-bg); padding: 30px; border-radius: 15px; max-width: 500px; width: 90%; box-shadow: 0 10px 40px var(--shadow); animation: modalSlideIn 0.3s ease; position: relative;" onclick="event.stopPropagation();">
            <div style="text-align: center; margin-bottom: 25px;">
                <div style="font-size: 64px; margin-bottom: 15px; animation: shake 0.5s ease;">ğŸ—‘ï¸</div>
                <h2 style="color: var(--text-primary); margin: 0 0 10px 0; font-size: 24px; font-weight: bold;">DosyayÄ± Sil</h2>
                <p style="color: var(--text-secondary); margin: 0; line-height: 1.6; font-size: 15px;">
                    "<span id="deleteFileName" style="font-weight: bold; color: var(--text-primary);"></span>" adlÄ± log dosyasÄ±nÄ± silmek istediÄŸinizden emin misiniz?
                </p>
                <div style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px; margin: 15px 0; text-align: left;">
                    <p style="color: var(--text-secondary); margin: 5px 0; font-size: 14px;">
                        <strong>ğŸ“Š Dosya Bilgileri:</strong><br>
                        <span id="deleteFileInfo" style="color: var(--text-primary);"></span>
                    </p>
                </div>
                <p style="color: var(--error-text); margin: 15px 0 0 0; font-size: 13px; font-weight: 500;">
                    âš ï¸ Bu iÅŸlem geri alÄ±namaz. Dosya ve tÃ¼m analiz verileri kalÄ±cÄ± olarak silinecektir.
                </p>
            </div>
            <div style="display: flex; gap: 10px; justify-content: center;">
                <button onclick="closeDeleteFileConfirmModal()" 
                        style="padding: 12px 30px; background: var(--bg-tertiary); color: var(--text-primary); border: 2px solid transparent; border-radius: 8px; cursor: pointer; font-weight: 500; transition: all 0.3s; min-width: 120px;"
                        onmouseover="this.style.background='var(--border-color)'; this.style.transform='translateY(-2px)'; this.style.borderColor='var(--border-color)';"
                        onmouseout="this.style.background='var(--bg-tertiary)'; this.style.transform='translateY(0)'; this.style.borderColor='transparent';">
                    Ä°ptal
                </button>
                <button onclick="confirmDeleteFile()" 
                        style="padding: 12px 30px; background: #dc3545; color: white; border: 2px solid #dc3545; border-radius: 8px; cursor: pointer; font-weight: bold; transition: all 0.3s; min-width: 120px;"
                        onmouseover="this.style.background='#c82333'; this.style.borderColor='#c82333'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 5px 15px rgba(220, 53, 69, 0.4)';"
                        onmouseout="this.style.background='#dc3545'; this.style.borderColor='#dc3545'; this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                    ğŸ—‘ï¸ Sil
                </button>
            </div>
        </div>
    </div>

    <!-- Comparison Modal -->
    <div id="comparisonModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 10004; justify-content: center; align-items: center; backdrop-filter: blur(5px); overflow-y: auto; padding: 20px;" onclick="if(event.target === this) closeComparisonModal();">
        <div style="background: var(--card-bg); padding: 30px; border-radius: 15px; max-width: 700px; width: 90%; box-shadow: 0 10px 40px var(--shadow); animation: modalSlideIn 0.3s ease; position: relative; margin: 20px auto;" onclick="event.stopPropagation();">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; border-bottom: 2px solid var(--bg-tertiary); padding-bottom: 15px;">
                <h2 style="color: var(--text-primary); margin: 0; font-size: 24px; display: flex; align-items: center; gap: 10px;">
                    <span style="font-size: 32px;">ğŸ“Š</span>
                    <span>Log DosyalarÄ±nÄ± KarÅŸÄ±laÅŸtÄ±r</span>
                </h2>
                <button onclick="closeComparisonModal()" style="background: transparent; border: none; font-size: 28px; cursor: pointer; color: var(--text-secondary); transition: transform 0.2s; width: 35px; height: 35px; display: flex; align-items: center; justify-content: center; border-radius: 50%;" onmouseover="this.style.transform='rotate(90deg)'; this.style.background='var(--bg-tertiary)';" onmouseout="this.style.transform='rotate(0deg)'; this.style.background='transparent';">âœ•</button>
            </div>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; color: var(--text-primary); font-weight: bold; font-size: 14px;">
                    Ä°lk Dosya <span style="color: var(--error-text);">*</span>
                </label>
                <select id="modalCompareFile1" 
                        style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; background: var(--input-bg); color: var(--text-primary); font-size: 14px; cursor: pointer; transition: border-color 0.3s;"
                        onfocus="this.style.borderColor='#667eea';" onblur="this.style.borderColor='var(--border-color)';">
                    <option value="">Dosya SeÃ§in</option>
                </select>
            </div>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; color: var(--text-primary); font-weight: bold; font-size: 14px;">
                    Ä°kinci Dosya <span style="color: var(--error-text);">*</span>
                </label>
                <select id="modalCompareFile2" 
                        style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; background: var(--input-bg); color: var(--text-primary); font-size: 14px; cursor: pointer; transition: border-color 0.3s;"
                        onfocus="this.style.borderColor='#667eea';" onblur="this.style.borderColor='var(--border-color)';">
                    <option value="">Dosya SeÃ§in</option>
                </select>
            </div>
            
            <div style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                <p style="color: var(--text-secondary); margin: 0; font-size: 13px; line-height: 1.6;">
                    <strong>ğŸ’¡ Bilgi:</strong> Ä°ki log dosyasÄ±nÄ± karÅŸÄ±laÅŸtÄ±rarak ortak hatalarÄ±, farklarÄ± ve istatistiksel deÄŸiÅŸiklikleri gÃ¶rebilirsiniz.
                </p>
            </div>
            
            <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 25px; padding-top: 20px; border-top: 2px solid var(--bg-tertiary);">
                <button onclick="closeComparisonModal()" 
                        style="padding: 12px 30px; background: var(--bg-tertiary); color: var(--text-primary); border: 2px solid transparent; border-radius: 8px; cursor: pointer; font-weight: 500; transition: all 0.3s; min-width: 120px;"
                        onmouseover="this.style.background='var(--border-color)'; this.style.transform='translateY(-2px)';" 
                        onmouseout="this.style.background='var(--bg-tertiary)'; this.style.transform='translateY(0)';">
                    Ä°ptal
                </button>
                <button onclick="submitComparison()" 
                        style="padding: 12px 30px; background: #17a2b8; color: white; border: 2px solid #17a2b8; border-radius: 8px; cursor: pointer; font-weight: bold; transition: all 0.3s; min-width: 120px;"
                        onmouseover="this.style.background='#138496'; this.style.borderColor='#138496'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 5px 15px rgba(23, 162, 184, 0.4)';" 
                        onmouseout="this.style.background='#17a2b8'; this.style.borderColor='#17a2b8'; this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                    ğŸ“Š KarÅŸÄ±laÅŸtÄ±r
                </button>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 10010; justify-content: center; align-items: center; backdrop-filter: blur(5px);" onclick="if(event.target === this) closeLoginModal();">
        <div style="background: var(--card-bg); padding: 30px; border-radius: 15px; max-width: 450px; width: 90%; box-shadow: 0 10px 40px var(--shadow); animation: modalSlideIn 0.3s ease; position: relative;" onclick="event.stopPropagation();">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; border-bottom: 2px solid var(--bg-tertiary); padding-bottom: 15px;">
                <h2 style="color: var(--text-primary); margin: 0; font-size: 24px;">ğŸ” GiriÅŸ Yap</h2>
                <button onclick="closeLoginModal()" style="background: transparent; border: none; font-size: 28px; cursor: pointer; color: var(--text-secondary);">âœ•</button>
            </div>
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; color: var(--text-primary); font-weight: 600;">KullanÄ±cÄ± AdÄ±</label>
                <input type="text" id="loginUsername" placeholder="KullanÄ±cÄ± adÄ±nÄ±zÄ± girin" style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; background: var(--input-bg); color: var(--text-primary); font-size: 14px;">
            </div>
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; color: var(--text-primary); font-weight: 600;">Åifre</label>
                <input type="password" id="loginPassword" placeholder="Åifrenizi girin" style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; background: var(--input-bg); color: var(--text-primary); font-size: 14px;">
            </div>
            <div id="loginError" style="display: none; padding: 10px; background: var(--error-bg); color: var(--error-text); border-radius: 6px; margin-bottom: 15px; font-size: 13px;"></div>
            <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 25px;">
                <button onclick="closeLoginModal()" style="padding: 12px 24px; background: var(--bg-tertiary); color: var(--text-primary); border: none; border-radius: 8px; cursor: pointer; font-weight: 500;">Ä°ptal</button>
                <button onclick="submitLogin()" style="padding: 12px 24px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">GiriÅŸ Yap</button>
            </div>
            <div style="margin-top: 15px; text-align: center; color: var(--text-secondary); font-size: 13px;">
                HesabÄ±nÄ±z yok mu? <a href="#" onclick="closeLoginModal(); showRegisterModal(); return false;" style="color: #667eea; text-decoration: none; font-weight: 600;">KayÄ±t Ol</a>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="registerModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 10011; justify-content: center; align-items: center; backdrop-filter: blur(5px); overflow-y: auto; padding: 20px;" onclick="if(event.target === this) closeRegisterModal();">
        <div style="background: var(--card-bg); padding: 30px; border-radius: 15px; max-width: 500px; width: 90%; box-shadow: 0 10px 40px var(--shadow); animation: modalSlideIn 0.3s ease; position: relative; margin: 20px auto;" onclick="event.stopPropagation();">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; border-bottom: 2px solid var(--bg-tertiary); padding-bottom: 15px;">
                <h2 style="color: var(--text-primary); margin: 0; font-size: 24px;">ğŸ“ KayÄ±t Ol</h2>
                <button onclick="closeRegisterModal()" style="background: transparent; border: none; font-size: 28px; cursor: pointer; color: var(--text-secondary);">âœ•</button>
            </div>
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 8px; color: var(--text-primary); font-weight: 600;">KullanÄ±cÄ± AdÄ± *</label>
                <input type="text" id="registerUsername" placeholder="KullanÄ±cÄ± adÄ±nÄ±zÄ± girin" style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; background: var(--input-bg); color: var(--text-primary); font-size: 14px;">
            </div>
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 8px; color: var(--text-primary); font-weight: 600;">Email *</label>
                <input type="email" id="registerEmail" placeholder="Email adresinizi girin" style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; background: var(--input-bg); color: var(--text-primary); font-size: 14px;">
            </div>
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 8px; color: var(--text-primary); font-weight: 600;">Ad Soyad</label>
                <input type="text" id="registerFullName" placeholder="AdÄ±nÄ±z ve soyadÄ±nÄ±z (opsiyonel)" style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; background: var(--input-bg); color: var(--text-primary); font-size: 14px;">
            </div>
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; color: var(--text-primary); font-weight: 600;">Åifre *</label>
                <input type="password" id="registerPassword" placeholder="Åifrenizi girin (min. 6 karakter)" style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; background: var(--input-bg); color: var(--text-primary); font-size: 14px;">
            </div>
            <div id="registerError" style="display: none; padding: 10px; background: var(--error-bg); color: var(--error-text); border-radius: 6px; margin-bottom: 15px; font-size: 13px;"></div>
            <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 25px;">
                <button onclick="closeRegisterModal()" style="padding: 12px 24px; background: var(--bg-tertiary); color: var(--text-primary); border: none; border-radius: 8px; cursor: pointer; font-weight: 500;">Ä°ptal</button>
                <button onclick="submitRegister()" style="padding: 12px 24px; background: #28a745; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">KayÄ±t Ol</button>
            </div>
            <div style="margin-top: 15px; text-align: center; color: var(--text-secondary); font-size: 13px;">
                Zaten hesabÄ±nÄ±z var mÄ±? <a href="#" onclick="closeRegisterModal(); showLoginModal(); return false;" style="color: #667eea; text-decoration: none; font-weight: 600;">GiriÅŸ Yap</a>
            </div>
        </div>
    </div>

    <!-- Profile Modal -->
    <div id="profileModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 10012; justify-content: center; align-items: center; backdrop-filter: blur(5px);" onclick="if(event.target === this) closeProfileModal();">
        <div style="background: var(--card-bg); padding: 30px; border-radius: 15px; max-width: 500px; width: 90%; box-shadow: 0 10px 40px var(--shadow); animation: modalSlideIn 0.3s ease; position: relative;" onclick="event.stopPropagation();">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; border-bottom: 2px solid var(--bg-tertiary); padding-bottom: 15px;">
                <h2 style="color: var(--text-primary); margin: 0; font-size: 24px;">ğŸ‘¤ Profil</h2>
                <button onclick="closeProfileModal()" style="background: transparent; border: none; font-size: 28px; cursor: pointer; color: var(--text-secondary);">âœ•</button>
            </div>
            <div id="profileContent">
                <!-- Profile content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Delete Alert Confirm Modal -->
    <div id="deleteAlertConfirmModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 10005; justify-content: center; align-items: center; backdrop-filter: blur(5px);" onclick="if(event.target === this) closeDeleteAlertConfirmModal();">
        <div style="background: var(--card-bg); padding: 30px; border-radius: 15px; max-width: 450px; width: 90%; box-shadow: 0 10px 40px var(--shadow); animation: modalSlideIn 0.3s ease; position: relative;" onclick="event.stopPropagation();">
            <div style="text-align: center; margin-bottom: 25px;">
                <div style="font-size: 64px; margin-bottom: 15px; animation: shake 0.5s ease;">ğŸš¨</div>
                <h2 style="color: var(--text-primary); margin: 0 0 10px 0; font-size: 24px; font-weight: bold;">Alert KuralÄ±nÄ± Sil</h2>
                <p style="color: var(--text-secondary); margin: 0; line-height: 1.6; font-size: 15px;">
                    "<span id="deleteAlertName" style="font-weight: bold; color: var(--text-primary);"></span>" adlÄ± alert kuralÄ±nÄ± silmek istediÄŸinizden emin misiniz?
                </p>
                <p style="color: var(--error-text); margin: 15px 0 0 0; font-size: 13px; font-weight: 500;">
                    âš ï¸ Bu iÅŸlem geri alÄ±namaz.
                </p>
            </div>
            <div style="display: flex; gap: 10px; justify-content: center;">
                <button onclick="closeDeleteAlertConfirmModal()" 
                        style="padding: 12px 30px; background: var(--bg-tertiary); color: var(--text-primary); border: 2px solid transparent; border-radius: 8px; cursor: pointer; font-weight: 500; transition: all 0.3s; min-width: 120px;"
                        onmouseover="this.style.background='var(--border-color)'; this.style.transform='translateY(-2px)'; this.style.borderColor='var(--border-color)';"
                        onmouseout="this.style.background='var(--bg-tertiary)'; this.style.transform='translateY(0)'; this.style.borderColor='transparent';">
                    Ä°ptal
                </button>
                <button onclick="confirmDeleteAlert()" 
                        style="padding: 12px 30px; background: #dc3545; color: white; border: 2px solid #dc3545; border-radius: 8px; cursor: pointer; font-weight: bold; transition: all 0.3s; min-width: 120px;"
                        onmouseover="this.style.background='#c82333'; this.style.borderColor='#c82333'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 5px 15px rgba(220, 53, 69, 0.4)';"
                        onmouseout="this.style.background='#dc3545'; this.style.borderColor='#dc3545'; this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                    ğŸ—‘ï¸ Sil
                </button>
            </div>
        </div>
    </div>

    <style>
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }
        @keyframes modalSlideIn {
            from {
                transform: scale(0.9) translateY(-20px);
                opacity: 0;
            }
            to {
                transform: scale(1) translateY(0);
                opacity: 1;
            }
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
    </style>

    <script>
        const API_BASE = '/api';
        let levelChart = null;
        let timeChart = null;
        let streamWebSocket = null;
        let streamFileId = null;
        let autoScroll = true;
        let logEntryCounter = 0; // SatÄ±r numarasÄ± iÃ§in sayaÃ§

        // Theme management
        function initTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            updateThemeIcon(savedTheme);
        }

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeIcon(newTheme);
            
            // Chart.js theme update
            if (levelChart) {
                levelChart.options.plugins.legend.labels.color = newTheme === 'dark' ? '#e0e0e0' : '#333';
                levelChart.update();
            }
            if (timeChart) {
                timeChart.options.plugins.legend.labels.color = newTheme === 'dark' ? '#e0e0e0' : '#333';
                timeChart.options.scales.x.ticks.color = newTheme === 'dark' ? '#e0e0e0' : '#333';
                timeChart.options.scales.y.ticks.color = newTheme === 'dark' ? '#e0e0e0' : '#333';
                timeChart.update();
            }
        }

        function updateThemeIcon(theme) {
            const icon = document.getElementById('themeIcon');
            icon.textContent = theme === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™';
        }

        // Section navigation
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected section
            const section = document.getElementById(sectionId + '-section');
            if (section) {
                section.classList.add('active');
            }
            
            // Activate corresponding tab
            const tabs = document.querySelectorAll('.nav-tab');
            tabs.forEach(tab => {
                if (tab.getAttribute('onclick') && tab.getAttribute('onclick').includes(sectionId)) {
                    tab.classList.add('active');
                }
            });
            
            // Load data if needed
            if (sectionId === 'files') {
                loadFiles();
            } else if (sectionId === 'saved-searches') {
                loadSavedSearches();
            } else if (sectionId === 'favorites') {
                loadFavorites();
            } else if (sectionId === 'alerts') {
                loadAlerts();
            } else if (sectionId === 'comparison') {
                updateComparisonSelects();
            } else if (sectionId === 'streaming') {
                updateStreamFileSelect();
            }
        }
        
        // Collapsible sections
        function toggleSection(element) {
            const content = element.nextElementSibling;
            if (content) {
                element.classList.toggle('collapsed');
                content.style.display = content.style.display === 'none' ? 'block' : 'none';
            }
        }

        // Real-time streaming
        function startStreaming() {
            const fileSelect = document.getElementById('streamFileSelect');
            if (!fileSelect) {
                alert('Streaming bÃ¶lÃ¼mÃ¼ henÃ¼z yÃ¼klenmedi. LÃ¼tfen sayfayÄ± yenileyin.');
                return;
            }
            
            const fileId = fileSelect.value;
            
            if (!fileId) {
                alert('LÃ¼tfen bir dosya seÃ§in!');
                return;
            }
            
            // Mevcut baÄŸlantÄ±yÄ± kapat
            if (streamWebSocket && streamWebSocket.readyState === WebSocket.OPEN) {
                streamWebSocket.close();
            }
            
            streamFileId = fileId;
            const levelFilter = document.getElementById('streamLevelFilter').value;
            const search = document.getElementById('streamSearch').value;
            
            // Arama geÃ§miÅŸine kaydet
            if (search) {
                saveSearchHistory(search, {
                    file_id: parseInt(fileId),
                    log_level: levelFilter || null,
                    search: search
                });
            }
            
            // WebSocket URL oluÅŸtur (protocol detection)
            const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
            let wsUrl = `${protocol}//${window.location.host}${API_BASE}/ws/logs/${fileId}`;
            const params = [];
            if (levelFilter) params.push(`log_level=${levelFilter}`);
            if (search) params.push(`search=${encodeURIComponent(search)}`);
            if (params.length > 0) wsUrl += '?' + params.join('&');
            
            console.log('WebSocket baÄŸlantÄ±sÄ± kuruluyor:', wsUrl);
            
            try {
                streamWebSocket = new WebSocket(wsUrl);
            } catch (error) {
                console.error('WebSocket oluÅŸturma hatasÄ±:', error);
                alert('WebSocket baÄŸlantÄ±sÄ± kurulamadÄ±: ' + error.message);
                return;
            }
            
            streamWebSocket.onopen = function() {
                document.getElementById('streamStatus').textContent = 'âœ… BaÄŸlantÄ± kuruldu - Loglar akÄ±yor...';
                document.getElementById('streamStatus').style.background = 'var(--success-bg)';
                document.getElementById('streamStatus').style.color = 'var(--success-text)';
                document.getElementById('startStreamBtn').style.display = 'none';
                document.getElementById('stopStreamBtn').style.display = 'inline-block';
                document.getElementById('streamLogs').innerHTML = '';
                logEntryCounter = 0; // SayaÃ§ sÄ±fÄ±rla
            };
            
            streamWebSocket.onmessage = function(event) {
                const message = JSON.parse(event.data);
                
                if (message.type === 'file_info') {
                    document.getElementById('streamStatus').textContent = 
                        `ğŸ“ ${message.data.filename} - ${message.data.total_lines} satÄ±r`;
                } else if (message.type === 'log_entry') {
                    addLogEntry(message.data);
                } else if (message.type === 'ready') {
                    document.getElementById('streamStatus').textContent = 
                        'âœ… Streaming aktif - Yeni loglar otomatik eklenecek';
                } else if (message.type === 'error') {
                    document.getElementById('streamStatus').textContent = 'âŒ Hata: ' + message.message;
                    document.getElementById('streamStatus').style.background = 'var(--error-bg)';
                    document.getElementById('streamStatus').style.color = 'var(--error-text)';
                }
            };
            
            streamWebSocket.onerror = function(error) {
                console.error('WebSocket hatasÄ±:', error);
                document.getElementById('streamStatus').textContent = 'âŒ BaÄŸlantÄ± hatasÄ± - Console\'u kontrol edin';
                document.getElementById('streamStatus').style.background = 'var(--error-bg)';
                document.getElementById('streamStatus').style.color = 'var(--error-text)';
            };
            
            streamWebSocket.onclose = function() {
                document.getElementById('streamStatus').textContent = 'ğŸ”Œ BaÄŸlantÄ± kapatÄ±ldÄ±';
                document.getElementById('streamStatus').style.background = 'var(--bg-tertiary)';
                document.getElementById('streamStatus').style.color = 'var(--text-secondary)';
                document.getElementById('startStreamBtn').style.display = 'inline-block';
                document.getElementById('stopStreamBtn').style.display = 'none';
                streamWebSocket = null;
            };
        }
        
        function stopStreaming() {
            if (streamWebSocket) {
                streamWebSocket.close();
                streamWebSocket = null;
            }
        }
        
        // Log renklendirme ve syntax highlighting
        function highlightLogMessage(message) {
            if (!message) return '';
            
            // HTML escape
            let highlighted = message
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;');
            
            // IP adresleri (IPv4)
            highlighted = highlighted.replace(/\b(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\b/g, 
                '<span style="color: #9b59b6; font-weight: 600;">$1</span>');
            
            // URL'ler
            highlighted = highlighted.replace(/(https?:\/\/[^\s]+)/g, 
                '<span style="color: #3498db; text-decoration: underline;">$1</span>');
            
            // Email adresleri
            highlighted = highlighted.replace(/\b([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,})\b/g, 
                '<span style="color: #e67e22;">$1</span>');
            
            // Tarih formatlarÄ± (YYYY-MM-DD, DD/MM/YYYY, vb.)
            highlighted = highlighted.replace(/\b(\d{4}-\d{2}-\d{2}|\d{2}\/\d{2}\/\d{4}|\d{2}\.\d{2}\.\d{4})\b/g, 
                '<span style="color: #16a085;">$1</span>');
            
            // SayÄ±lar (bÃ¼yÃ¼k sayÄ±lar)
            highlighted = highlighted.replace(/\b(\d{4,})\b/g, 
                '<span style="color: #27ae60; font-weight: 500;">$1</span>');
            
            // HTTP status kodlarÄ±
            highlighted = highlighted.replace(/\b(HTTP\/\d\.\d|Status:\s*\d{3}|Status Code:\s*\d{3})\b/gi, 
                '<span style="color: #c0392b; font-weight: 600;">$1</span>');
            
            // Hata mesajlarÄ± (error, exception, fail, vb.)
            highlighted = highlighted.replace(/\b(error|exception|failed|failure|fatal|critical|timeout|deadlock)\b/gi, 
                '<span style="color: #e74c3c; font-weight: 600; background: rgba(231, 76, 60, 0.1); padding: 1px 3px; border-radius: 3px;">$1</span>');
            
            // UyarÄ± mesajlarÄ±
            highlighted = highlighted.replace(/\b(warning|warn|alert|caution)\b/gi, 
                '<span style="color: #f39c12; font-weight: 600;">$1</span>');
            
            // BaÅŸarÄ± mesajlarÄ±
            highlighted = highlighted.replace(/\b(success|successful|completed|ok|done)\b/gi, 
                '<span style="color: #27ae60; font-weight: 600;">$1</span>');
            
            // SQL sorgularÄ±
            highlighted = highlighted.replace(/\b(SELECT|INSERT|UPDATE|DELETE|CREATE|DROP|ALTER|FROM|WHERE|JOIN|INNER|OUTER|LEFT|RIGHT)\b/gi, 
                '<span style="color: #8e44ad; font-weight: 600; font-style: italic;">$1</span>');
            
            // JSON/XML yapÄ±larÄ±
            highlighted = highlighted.replace(/(\{[^}]*\}|\[[^\]]*\]|&lt;[^&gt;]*&gt;)/g, 
                '<span style="color: #2980b9; font-family: \'Courier New\', monospace;">$1</span>');
            
            return highlighted;
        }
        
        function addLogEntry(entry) {
            const logsDiv = document.getElementById('streamLogs');
            const logEntry = document.createElement('div');
            logEntryCounter++;
            const lineNumber = logEntryCounter;
            
            // Log level'e gÃ¶re arka plan rengi
            let bgColor = 'transparent';
            let levelColor = '#666';
            let borderColor = 'var(--bg-tertiary)';
            
            if (entry.log_level === 'ERROR') {
                bgColor = 'rgba(231, 76, 60, 0.08)';
                levelColor = '#e74c3c';
                borderColor = 'rgba(231, 76, 60, 0.3)';
            } else if (entry.log_level === 'WARNING') {
                bgColor = 'rgba(243, 156, 18, 0.08)';
                levelColor = '#f39c12';
                borderColor = 'rgba(243, 156, 18, 0.3)';
            } else if (entry.log_level === 'INFO') {
                bgColor = 'rgba(52, 152, 219, 0.05)';
                levelColor = '#3498db';
                borderColor = 'rgba(52, 152, 219, 0.2)';
            } else if (entry.log_level === 'DEBUG') {
                bgColor = 'rgba(149, 165, 166, 0.05)';
                levelColor = '#95a5a6';
                borderColor = 'rgba(149, 165, 166, 0.2)';
            }
            
            logEntry.className = 'log-entry';
            logEntry.setAttribute('data-entry-id', entry.id || lineNumber);
            logEntry.style.cssText = `
                padding: 8px 12px;
                margin-bottom: 4px;
                border-left: 3px solid ${borderColor};
                background: ${bgColor};
                border-radius: 4px;
                transition: all 0.2s;
                font-family: 'Courier New', monospace;
                font-size: 12px;
                line-height: 1.5;
                cursor: pointer;
                position: relative;
            `;
            
            logEntry.onmouseover = function() {
                this.style.background = bgColor !== 'transparent' ? bgColor.replace('0.08', '0.15').replace('0.05', '0.12') : 'var(--bg-tertiary)';
                this.style.transform = 'translateX(3px)';
            };
            logEntry.onmouseout = function() {
                this.style.background = bgColor;
                this.style.transform = 'translateX(0)';
            };
            
            // TÄ±klayÄ±nca detay gÃ¶ster
            logEntry.onclick = function() {
                showLogEntryDetails(entry, lineNumber);
            };
            
            const timestamp = entry.timestamp ? new Date(entry.timestamp).toLocaleTimeString('tr-TR') : '';
            const highlightedMessage = highlightLogMessage(entry.message);
            
            logEntry.innerHTML = `
                <div style="display: flex; align-items: start; gap: 10px;">
                    <span style="color: var(--text-secondary); min-width: 50px; font-size: 10px; font-weight: 600; flex-shrink: 0; user-select: none;" title="SatÄ±r ${lineNumber}">#${lineNumber}</span>
                    <span style="color: ${levelColor}; font-weight: bold; min-width: 70px; font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px; flex-shrink: 0;">[${entry.log_level || 'UNKNOWN'}]</span>
                    <span style="color: var(--text-secondary); min-width: 80px; font-size: 11px; flex-shrink: 0;">${timestamp}</span>
                    <span style="color: var(--text-primary); flex: 1; word-break: break-word;">${highlightedMessage}</span>
                    <button onclick="event.stopPropagation(); copyLogEntry(${lineNumber}, '${entry.message.replace(/'/g, "\\'").replace(/"/g, '&quot;')}')" 
                            style="background: transparent; border: none; color: var(--text-secondary); cursor: pointer; padding: 4px 8px; border-radius: 4px; font-size: 14px; transition: all 0.2s; flex-shrink: 0;" 
                            title="Kopyala"
                            onmouseover="this.style.background='var(--bg-tertiary)'; this.style.color='var(--accent-color)';"
                            onmouseout="this.style.background='transparent'; this.style.color='var(--text-secondary)';">
                        ğŸ“‹
                    </button>
                </div>
            `;
            
            logsDiv.appendChild(logEntry);
            
            // Auto-scroll
            if (autoScroll) {
                logsDiv.scrollTop = logsDiv.scrollHeight;
            }
        }
        
        function copyLogEntry(lineNumber, message) {
            const fullText = `#${lineNumber}: ${message}`;
            navigator.clipboard.writeText(fullText).then(() => {
                showNotification(`SatÄ±r #${lineNumber} kopyalandÄ±!`, 'success');
            }).catch(err => {
                console.error('Kopyalama hatasÄ±:', err);
                // Fallback: textarea kullan
                const textarea = document.createElement('textarea');
                textarea.value = fullText;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                showNotification(`SatÄ±r #${lineNumber} kopyalandÄ±!`, 'success');
            });
        }
        
        function showLogEntryDetails(entry, lineNumber) {
            const modal = document.createElement('div');
            modal.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 10006; display: flex; justify-content: center; align-items: center; backdrop-filter: blur(5px);';
            modal.onclick = function(e) {
                if (e.target === modal) {
                    modal.remove();
                }
            };
            
            const timestamp = entry.timestamp ? new Date(entry.timestamp).toLocaleString('tr-TR') : 'N/A';
            const highlightedMessage = highlightLogMessage(entry.message);
            
            modal.innerHTML = `
                <div style="background: var(--card-bg); padding: 25px; border-radius: 15px; max-width: 700px; width: 90%; box-shadow: 0 10px 40px var(--shadow); animation: modalSlideIn 0.3s ease; position: relative; max-height: 80vh; overflow-y: auto;" onclick="event.stopPropagation();">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 2px solid var(--bg-tertiary); padding-bottom: 15px;">
                        <h2 style="color: var(--text-primary); margin: 0; font-size: 20px;">ğŸ“„ Log DetaylarÄ± - SatÄ±r #${lineNumber}</h2>
                        <button onclick="this.closest('div[style*=\"position: fixed\"]').remove()" 
                                style="background: transparent; border: none; font-size: 24px; cursor: pointer; color: var(--text-secondary); transition: transform 0.2s; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; border-radius: 50%;"
                                onmouseover="this.style.transform='rotate(90deg)'; this.style.background='var(--bg-tertiary)';"
                                onmouseout="this.style.transform='rotate(0deg)'; this.style.background='transparent';">âœ•</button>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; color: var(--text-secondary); font-size: 12px; font-weight: 600;">Log Seviyesi</label>
                        <div style="padding: 10px; background: var(--bg-tertiary); border-radius: 6px; color: var(--text-primary); font-weight: 600;">
                            ${entry.log_level || 'UNKNOWN'}
                        </div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; color: var(--text-secondary); font-size: 12px; font-weight: 600;">Zaman DamgasÄ±</label>
                        <div style="padding: 10px; background: var(--bg-tertiary); border-radius: 6px; color: var(--text-primary);">
                            ${timestamp}
                        </div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; color: var(--text-secondary); font-size: 12px; font-weight: 600;">Mesaj</label>
                        <div style="padding: 15px; background: var(--bg-tertiary); border-radius: 6px; color: var(--text-primary); font-family: 'Courier New', monospace; font-size: 13px; line-height: 1.6; white-space: pre-wrap; word-break: break-word; max-height: 300px; overflow-y: auto;">
                            ${highlightedMessage}
                        </div>
                    </div>
                    ${entry.id ? `
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; margin-bottom: 5px; color: var(--text-secondary); font-size: 12px; font-weight: 600;">Entry ID</label>
                            <div style="padding: 10px; background: var(--bg-tertiary); border-radius: 6px; color: var(--text-primary); font-family: monospace;">
                                ${entry.id}
                            </div>
                        </div>
                    ` : ''}
                    <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px; padding-top: 15px; border-top: 2px solid var(--bg-tertiary);">
                        <button onclick="copyLogEntry(${lineNumber}, '${entry.message.replace(/'/g, "\\'").replace(/"/g, '&quot;')}'); this.closest('div[style*=\"position: fixed\"]').remove();" 
                                style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 500; transition: all 0.3s;"
                                onmouseover="this.style.background='#5568d3'; this.style.transform='translateY(-2px)';"
                                onmouseout="this.style.background='#667eea'; this.style.transform='translateY(0)';">ğŸ“‹ Kopyala</button>
                        <button onclick="this.closest('div[style*=\"position: fixed\"]').remove()" 
                                style="padding: 10px 20px; background: var(--bg-tertiary); color: var(--text-primary); border: none; border-radius: 6px; cursor: pointer; font-weight: 500; transition: all 0.3s;"
                                onmouseover="this.style.background='var(--border-color)';"
                                onmouseout="this.style.background='var(--bg-tertiary)';">Kapat</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // ESC tuÅŸu ile kapat
            const escHandler = function(e) {
                if (e.key === 'Escape') {
                    modal.remove();
                    document.removeEventListener('keydown', escHandler);
                }
            };
            document.addEventListener('keydown', escHandler);
        }
        
        // Saved Searches
        async function loadSavedSearches() {
            try {
                const response = await fetch(`${API_BASE}/saved-searches`, {
                    headers: getAuthHeaders()
                });
                const searches = await response.json();
                
                const listDiv = document.getElementById('savedSearchesList');
                const emptyDiv = document.getElementById('savedSearchesEmpty');
                
                if (searches.length === 0) {
                    listDiv.style.display = 'none';
                    emptyDiv.style.display = 'block';
                    return;
                }
                
                listDiv.style.display = 'grid';
                emptyDiv.style.display = 'none';
                
                listDiv.innerHTML = searches.map(search => `
                    <div class="saved-search-card" style="background: var(--card-bg); padding: 15px; border-radius: 8px; border: 1px solid var(--bg-tertiary); cursor: pointer; transition: all 0.3s;" 
                         onclick="useSavedSearch(${search.id})"
                         onmouseover="this.style.borderColor='var(--border-color)'; this.style.transform='translateY(-2px)';"
                         onmouseout="this.style.borderColor='var(--bg-tertiary)'; this.style.transform='translateY(0)';">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                            <h4 style="color: var(--text-primary); margin: 0; font-size: 16px;">${search.name}</h4>
                            <button onclick="event.stopPropagation(); deleteSavedSearch(${search.id})" 
                                    style="background: transparent; border: none; color: var(--error-text); cursor: pointer; font-size: 18px; padding: 0 5px; transition: transform 0.2s;" 
                                    onmouseover="this.style.transform='scale(1.2)';"
                                    onmouseout="this.style.transform='scale(1)';"
                                    title="Sil">âœ•</button>
                        </div>
                        ${search.description ? `<p style="color: var(--text-secondary); font-size: 12px; margin: 5px 0;">${search.description}</p>` : ''}
                        <div style="display: flex; gap: 10px; margin-top: 10px; font-size: 11px; color: var(--text-secondary);">
                            <span>ğŸ“Š ${search.use_count} kullanÄ±m</span>
                            ${search.last_used_at ? `<span>ğŸ•’ ${new Date(search.last_used_at).toLocaleDateString('tr-TR')}</span>` : ''}
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('KayÄ±tlÄ± aramalar yÃ¼kleme hatasÄ±:', error);
            }
        }
        
        async function useSavedSearch(searchId) {
            try {
                const response = await fetch(`${API_BASE}/saved-searches/${searchId}/use`, {
                    method: 'PUT'
                });
                const data = await response.json();
                
                // Arama parametrelerini uygula
                const params = data.search_params;
                
                // Streaming section'a git
                showSection('streaming');
                
                // Filtreleri uygula
                if (params.file_id) {
                    const fileSelect = document.getElementById('streamFileSelect');
                    if (fileSelect) {
                        fileSelect.value = params.file_id;
                    }
                }
                
                if (params.log_level) {
                    const levelFilter = document.getElementById('streamLevelFilter');
                    if (levelFilter) {
                        levelFilter.value = params.log_level;
                    }
                }
                
                if (params.search) {
                    const searchInput = document.getElementById('streamSearch');
                    if (searchInput) {
                        searchInput.value = params.search;
                    }
                }
                
                // Streaming baÅŸlat
                if (params.file_id) {
                    setTimeout(() => {
                        startStreaming();
                    }, 300);
                }
                
                // BaÅŸarÄ± mesajÄ±
                showNotification(`"${data.name}" aramasÄ± uygulandÄ±`, 'success');
            } catch (error) {
                console.error('KayÄ±tlÄ± arama kullanma hatasÄ±:', error);
                showNotification('Arama uygulanÄ±rken hata oluÅŸtu', 'error');
            }
        }
        
        let deleteSearchId = null;
        
        function showDeleteConfirmModal(searchId, searchName) {
            deleteSearchId = searchId;
            const modal = document.getElementById('deleteConfirmModal');
            const searchNameSpan = document.getElementById('deleteSearchName');
            if (searchNameSpan) {
                searchNameSpan.textContent = searchName;
            }
            if (modal) {
                modal.style.display = 'flex';
            }
        }
        
        function closeDeleteConfirmModal() {
            const modal = document.getElementById('deleteConfirmModal');
            if (modal) {
                modal.style.display = 'none';
            }
            deleteSearchId = null;
        }
        
        async function confirmDeleteSavedSearch() {
            if (!deleteSearchId) return;
            
            const searchId = deleteSearchId;
            closeDeleteConfirmModal();
            
            try {
                const response = await fetch(`${API_BASE}/saved-searches/${searchId}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    loadSavedSearches();
                    showNotification('KayÄ±tlÄ± arama silindi', 'success');
                } else {
                    throw new Error('Silme hatasÄ±');
                }
            } catch (error) {
                console.error('KayÄ±tlÄ± arama silme hatasÄ±:', error);
                showNotification('Arama silinirken hata oluÅŸtu', 'error');
            }
        }
        
        async function deleteSavedSearch(searchId) {
            // Ã–nce arama adÄ±nÄ± al
            try {
                const response = await fetch(`${API_BASE}/saved-searches/${searchId}`);
                const search = await response.json();
                showDeleteConfirmModal(searchId, search.name);
            } catch (error) {
                console.error('Arama bilgisi alÄ±namadÄ±:', error);
                showDeleteConfirmModal(searchId, 'bu arama');
            }
        }
        
        function showSaveSearchModal() {
            const modal = document.getElementById('saveSearchModal');
            if (modal) {
                modal.style.display = 'flex';
            }
        }
        
        function closeSaveSearchModal() {
            const modal = document.getElementById('saveSearchModal');
            if (modal) {
                modal.style.display = 'none';
                document.getElementById('saveSearchName').value = '';
                document.getElementById('saveSearchDescription').value = '';
            }
        }
        
        async function saveCurrentSearch() {
            const name = document.getElementById('saveSearchName').value.trim();
            if (!name) {
                alert('LÃ¼tfen bir isim girin!');
                return;
            }
            
            // Mevcut arama parametrelerini topla
            const fileSelect = document.getElementById('streamFileSelect');
            const levelFilter = document.getElementById('streamLevelFilter');
            const searchInput = document.getElementById('streamSearch');
            
            const searchParams = {};
            if (fileSelect && fileSelect.value) {
                searchParams.file_id = parseInt(fileSelect.value);
            }
            if (levelFilter && levelFilter.value) {
                searchParams.log_level = levelFilter.value;
            }
            if (searchInput && searchInput.value) {
                searchParams.search = searchInput.value;
            }
            
            if (Object.keys(searchParams).length === 0) {
                alert('LÃ¼tfen Ã¶nce bir arama yapÄ±n!');
                return;
            }
            
            const description = document.getElementById('saveSearchDescription').value.trim();
            
            try {
                const response = await fetch(`${API_BASE}/saved-searches`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        name: name,
                        description: description || null,
                        search_params: searchParams
                    })
                });
                
                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.detail || 'Kaydetme hatasÄ±');
                }
                
                const saved = await response.json();
                loadSavedSearches();
                closeSaveSearchModal();
                showNotification(`"${saved.name}" kaydedildi!`, 'success');
            } catch (error) {
                console.error('Arama kaydetme hatasÄ±:', error);
                alert('Hata: ' + error.message);
            }
        }
        
        function showNotification(message, type) {
            // Basit notification sistemi
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                background: ${type === 'success' ? 'var(--success-bg)' : 'var(--error-bg)'};
                color: ${type === 'success' ? 'var(--success-text)' : 'var(--error-text)'};
                border-radius: 8px;
                box-shadow: 0 5px 15px var(--shadow);
                z-index: 10000;
                animation: slideIn 0.3s ease;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }
        
        // ESC tuÅŸu ile modal kapatma
        // Keyboard Shortcuts
        document.addEventListener('keydown', function(event) {
            // Ctrl/Cmd + F - Arama (streaming section'da)
            if ((event.ctrlKey || event.metaKey) && event.key === 'f') {
                const streamSearch = document.getElementById('streamSearch');
                const streamingSection = document.getElementById('streaming-section');
                if (streamSearch && streamingSection && streamingSection.classList.contains('active')) {
                    event.preventDefault();
                    streamSearch.focus();
                }
            }
            
            // Ctrl/Cmd + D - Dark mode toggle
            if ((event.ctrlKey || event.metaKey) && event.key === 'd') {
                event.preventDefault();
                toggleTheme();
            }
            
            // Ctrl/Cmd + S - Export (if analysis modal is open)
            if ((event.ctrlKey || event.metaKey) && event.key === 's') {
                event.preventDefault();
                // Export functionality will be triggered from analysis modal
            }
            
            // ESC - Close modals
            if (event.key === 'Escape') {
                closeLoginModal();
                closeRegisterModal();
                closeProfileModal();
                closeDeleteConfirmModal();
                closeSaveSearchModal();
                closeCreateAlertModal();
                closeComparisonModal();
                closeComparisonResults();
                closeDeleteFileConfirmModal();
                closeDeleteAlertConfirmModal();
            }
        });
        
        // Sayfa yÃ¼klendiÄŸinde
        window.onload = function() {
            initTheme();
            
            // Dashboard section'Ä± aktif yap (ilk)
            showSection('dashboard');
            
            loadDashboard();
            loadFiles();
            loadSavedSearches();
            loadFavorites();
            loadAlerts();
            loadWidgetLayout(); // Load widget layout
            initDragAndDrop(); // Initialize drag and drop
            
            // Dosya listesini stream select'e ekle
            setTimeout(() => {
                updateStreamFileSelect();
                updateComparisonSelects();
            }, 1000);
        };
        
        function updateStreamFileSelect() {
            fetch(`${API_BASE}/logs/`, {
                headers: getAuthHeaders()
            })
                .then(res => res.json())
                .then(files => {
                    const select = document.getElementById('streamFileSelect');
                    select.innerHTML = '<option value="">Dosya SeÃ§in</option>';
                    files.forEach(file => {
                        const option = document.createElement('option');
                        option.value = file.id;
                        option.textContent = `${file.filename} (${file.total_lines} satÄ±r)`;
                        select.appendChild(option);
                    });
                });
        }

        // Drag & Drop dosya yÃ¼kleme
        function initDragAndDrop() {
            const dropArea = document.getElementById('dropArea');
            const fileInput = document.getElementById('fileInput');

            if (!dropArea || !fileInput) return;

            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, preventDefaults, false);
            });

            ['dragenter', 'dragover'].forEach(eventName => {
                dropArea.addEventListener(eventName, () => dropArea.classList.add('highlight'), false);
            });

            ['dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, () => dropArea.classList.remove('highlight'), false);
            });

            dropArea.addEventListener('drop', handleDrop, false);
            fileInput.addEventListener('change', handleFileSelect, false);

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                fileInput.files = files; // Set files to the input element
                uploadFile(); // Trigger upload
            }

            function handleFileSelect(e) {
                // Files are already in fileInput.files due to the change event
                uploadFile(); // Trigger upload
            }
        }

        // Dosya yÃ¼kleme
        async function uploadFile() {
            const fileInput = document.getElementById('fileInput');
            const useAI = document.getElementById('useAI').checked;
            const statusDiv = document.getElementById('uploadStatus');

            if (fileInput.files.length === 0) {
                showNotification('LÃ¼tfen yÃ¼klenecek bir dosya seÃ§in veya sÃ¼rÃ¼kleyin.', 'error');
                return;
            }

            statusDiv.innerHTML = '<div class="loading active">â³ YÃ¼kleniyor ve analiz ediliyor...</div>';

            const filesToUpload = Array.from(fileInput.files);
            let allSuccess = true;
            let uploadedCount = 0;

            for (const file of filesToUpload) {
                const formData = new FormData();
                formData.append('file', file);

                try {
                    const token = getAuthToken();
                    const headers = {};
                    if (token) {
                        headers['Authorization'] = `Bearer ${token}`;
                    }
                    const response = await fetch(`${API_BASE}/logs/upload?use_ai=${useAI}`, {
                        method: 'POST',
                        headers: headers,
                        body: formData
                    });

                    if (!response.ok) {
                        throw new Error(`YÃ¼kleme hatasÄ±: ${file.name}`);
                    }

                    const result = await response.json();
                    uploadedCount++;
                    showNotification(`âœ… Dosya "${file.name}" baÅŸarÄ±yla yÃ¼klendi ve analiz edildi!`, 'success');

                    // Refresh dashboard and files after each upload
                    loadDashboard();
                    loadFiles();
                    if (result.id && uploadedCount === filesToUpload.length) {
                        // Optionally show analysis for the last uploaded file
                        // showAnalysis(result.id);
                    }
                } catch (error) {
                    allSuccess = false;
                    console.error(`Dosya "${file.name}" yÃ¼kleme hatasÄ±:`, error);
                    showNotification(`âŒ Dosya "${file.name}" yÃ¼klenirken hata oluÅŸtu: ${error.message}`, 'error');
                }
            }

            if (allSuccess) {
                statusDiv.innerHTML = `<div class="success">âœ… TÃ¼m ${uploadedCount} dosya baÅŸarÄ±yla yÃ¼klendi ve analiz edildi!</div>`;
            } else {
                statusDiv.innerHTML = `<div class="error">âŒ BazÄ± dosyalar yÃ¼klenirken hata oluÅŸtu.</div>`;
            }
            fileInput.value = ''; // Clear file input
            setTimeout(() => statusDiv.innerHTML = '', 5000); // Clear status after 5 seconds
        }

        // Dashboard istatistiklerini yÃ¼kle
        async function loadDashboard() {
            try {
                const response = await fetch(`${API_BASE}/dashboard/stats`, {
                    headers: getAuthHeaders()
                });
                const stats = await response.json();

                const statsDiv = document.getElementById('dashboardStats');
                statsDiv.innerHTML = `
                    <div class="stat-card">
                        <h3>${stats.total_files}</h3>
                        <p>Toplam Dosya</p>
                    </div>
                    <div class="stat-card">
                        <h3>${stats.total_entries.toLocaleString()}</h3>
                        <p>Toplam Log GiriÅŸi</p>
                    </div>
                    <div class="stat-card">
                        <h3>${stats.total_errors.toLocaleString()}</h3>
                        <p>Toplam Hata</p>
                    </div>
                    <div class="stat-card">
                        <h3>${stats.total_warnings.toLocaleString()}</h3>
                        <p>Toplam UyarÄ±</p>
                    </div>
                `;
            } catch (error) {
                console.error('Dashboard yÃ¼kleme hatasÄ±:', error);
            }
        }

        // DosyalarÄ± listele
        async function loadFiles() {
            try {
                const tagFilter = document.getElementById('tagFilter')?.value || '';
                const categoryFilter = document.getElementById('categoryFilter')?.value || '';
                
                let url = `${API_BASE}/logs/`;
                const params = [];
                if (tagFilter) params.push(`tags=${encodeURIComponent(tagFilter)}`);
                if (categoryFilter) params.push(`category_id=${categoryFilter}`);
                if (params.length > 0) url += '?' + params.join('&');
                
                const response = await fetch(url, {
                    headers: getAuthHeaders()
                });
                const files = await response.json();

                const filesDiv = document.getElementById('filesList');
                if (files.length === 0) {
                    filesDiv.innerHTML = '<p>HenÃ¼z dosya yÃ¼klenmemiÅŸ.</p>';
                    return;
                }

                // Favorites listesini al
                const favoritesRes = await fetch(`${API_BASE}/favorites`, {
                    headers: getAuthHeaders()
                });
                const favorites = favoritesRes.ok ? await favoritesRes.json() : [];
                const favoriteIds = new Set(favorites.map(f => f.log_file_id));
                
                filesDiv.innerHTML = files.map(file => {
                    const isFavorite = favoriteIds.has(file.id);
                    const tags = file.tags || [];
                    const category = file.category || null;
                    return `
                        <div class="file-item" data-file-id="${file.id}">
                            <div style="display: flex; align-items: start; gap: 12px;">
                                <input type="checkbox" class="file-checkbox" data-file-id="${file.id}" onchange="updateBulkActionsToolbar()" style="margin-top: 5px; width: 18px; height: 18px; cursor: pointer;">
                                <div class="file-info" style="flex: 1;">
                                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px; flex-wrap: wrap;">
                                        <h3 style="margin: 0; flex: 1;">${file.filename} ${isFavorite ? 'â­' : ''}</h3>
                                        ${category ? `<span style="background: ${category.color || '#667eea'}; color: white; padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">${category.icon || 'ğŸ“'} ${category.name}</span>` : ''}
                                    </div>
                                    <p style="margin: 5px 0; color: var(--text-secondary); font-size: 13px;">
                                        ${file.total_lines} satÄ±r | 
                                        ${new Date(file.uploaded_at).toLocaleString('tr-TR')} | 
                                        Durum: ${file.status}
                                    </p>
                                    ${tags.length > 0 ? `
                                        <div style="display: flex; flex-wrap: wrap; gap: 6px; margin-top: 8px;">
                                            ${tags.map(tag => `
                                                <span style="background: ${tag.color || '#667eea'}; color: white; padding: 3px 8px; border-radius: 10px; font-size: 11px; font-weight: 500; cursor: pointer;" 
                                                      onclick="filterByTag('${tag.name}')" 
                                                      title="Filtrele: ${tag.name}">
                                                    ${tag.name}
                                                </span>
                                            `).join('')}
                                        </div>
                                    ` : ''}
                                </div>
                            </div>
                            <div class="file-actions">
                                <button onclick="showFileTagsModal(${file.id})" style="background: #667eea; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; font-weight: 500; font-size: 12px;" title="Etiketler">ğŸ·ï¸</button>
                                <button onclick="showFileCategoryModal(${file.id})" style="background: #17a2b8; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; font-weight: 500; font-size: 12px;" title="Kategori">ğŸ“</button>
                                <button onclick="toggleFavorite(${file.id}, ${isFavorite})" style="background: ${isFavorite ? '#ffc107' : '#6c757d'};" title="${isFavorite ? 'Favorilerden KaldÄ±r' : 'Favorilere Ekle'}">
                                    ${isFavorite ? 'â­' : 'â˜†'}
                                </button>
                                <button class="btn-info" onclick="showAnalysis(${file.id})">Analiz</button>
                                <button class="btn-info" onclick="startStreamingForFile(${file.id})" style="background: #28a745;">ğŸ“¡ CanlÄ± Ä°zle</button>
                                <button onclick="showComparisonForFile(${file.id})" style="background: #17a2b8;">KarÅŸÄ±laÅŸtÄ±r</button>
                                <button class="btn-danger" onclick="deleteFile(${file.id})">Sil</button>
                            </div>
                        </div>
                    `;
                }).join('');
                
                // Load tags and categories for filters
                loadTagsForFilter();
                loadCategoriesForFilter();
                
                // Stream file select ve comparison selects'i gÃ¼ncelle
                updateStreamFileSelect();
                updateComparisonSelects();
            } catch (error) {
                console.error('Dosya listeleme hatasÄ±:', error);
            }
        }
        
        function startStreamingForFile(fileId) {
            console.log('startStreamingForFile Ã§aÄŸrÄ±ldÄ±, fileId:', fileId);
            
            // Streaming section'Ä± gÃ¶ster
            showSection('streaming');
            
            // Select'i gÃ¼ncelle
            setTimeout(() => {
                const fileSelect = document.getElementById('streamFileSelect');
                if (fileSelect) {
                    fileSelect.value = fileId;
                    startStreaming();
                } else {
                    console.error('streamFileSelect elementi bulunamadÄ±!');
                }
            }, 100);
        }

        // Analiz gÃ¶ster
        async function showAnalysis(fileId) {
            try {
                const [analysisRes, entriesRes] = await Promise.all([
                    fetch(`${API_BASE}/analysis/${fileId}`, {
                        headers: getAuthHeaders()
                    }),
                    fetch(`${API_BASE}/analysis/${fileId}/entries?limit=1000`, {
                        headers: getAuthHeaders()
                    })
                ]);

                const analysis = await analysisRes.json();
                const entries = await entriesRes.json();

                // Charts grid'i gÃ¶ster
                const chartsGrid = document.getElementById('chartsGrid');
                if (chartsGrid) chartsGrid.style.display = 'grid';
                
                // Log seviyesi grafiÄŸi
                const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
                const textColor = isDark ? '#e0e0e0' : '#333';
                const levelCtx = document.getElementById('levelChart').getContext('2d');
                if (levelChart) levelChart.destroy();
                levelChart = new Chart(levelCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Hatalar', 'UyarÄ±lar', 'Bilgiler', 'Debug'],
                        datasets: [{
                            data: [
                                analysis.error_count,
                                analysis.warning_count,
                                analysis.info_count,
                                analysis.debug_count
                            ],
                            backgroundColor: [
                                '#dc3545',
                                '#ffc107',
                                '#28a745',
                                '#17a2b8'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        aspectRatio: 1.2,
                        plugins: {
                            title: {
                                display: false
                            },
                            legend: {
                                position: 'bottom',
                                labels: {
                                    color: textColor,
                                    padding: 12,
                                    font: {
                                        size: 12
                                    }
                                }
                            }
                        }
                    }
                });

                // Zaman daÄŸÄ±lÄ±mÄ± grafiÄŸi
                if (analysis.time_distribution) {
                    const timeCtx = document.getElementById('timeChart').getContext('2d');
                    const hours = Object.keys(analysis.time_distribution).sort();
                    const counts = hours.map(h => analysis.time_distribution[h]);
                    
                    if (timeChart) timeChart.destroy();
                    timeChart = new Chart(timeCtx, {
                        type: 'bar',
                        data: {
                            labels: hours.map(h => h + ':00'),
                            datasets: [{
                                label: 'Log SayÄ±sÄ±',
                                data: counts,
                                backgroundColor: '#667eea'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: true,
                            aspectRatio: 2,
                            plugins: {
                                title: {
                                    display: false
                                },
                                legend: {
                                    display: false
                                }
                            },
                            scales: {
                                x: {
                                    ticks: {
                                        color: textColor
                                    },
                                    grid: {
                                        color: isDark ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.1)'
                                    }
                                },
                                y: {
                                    beginAtZero: true,
                                    ticks: {
                                        color: textColor
                                    },
                                    grid: {
                                        color: isDark ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.1)'
                                    }
                                }
                            }
                        }
                    });
                }

                // Export butonlarÄ±
                const exportDiv = document.createElement('div');
                exportDiv.className = 'chart-container';
                exportDiv.innerHTML = `
                    <h3 style="color: var(--text-primary); margin-bottom: 15px;">ğŸ“¥ Export SeÃ§enekleri</h3>
                    <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                        <button onclick="exportLogs(${fileId}, 'json', false)" style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 500; transition: all 0.3s;" onmouseover="this.style.background='#218838'; this.style.transform='translateY(-2px)';" onmouseout="this.style.background='#28a745'; this.style.transform='translateY(0)';">ğŸ“„ JSON Export</button>
                        <button onclick="exportLogs(${fileId}, 'xml', false)" style="padding: 10px 20px; background: #17a2b8; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 500; transition: all 0.3s;" onmouseover="this.style.background='#138496'; this.style.transform='translateY(-2px)';" onmouseout="this.style.background='#17a2b8'; this.style.transform='translateY(0)';">ğŸ“‹ XML Export</button>
                        <button onclick="exportLogs(${fileId}, 'json', true)" style="padding: 10px 20px; background: #6f42c1; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 500; transition: all 0.3s;" onmouseover="this.style.background='#5a32a3'; this.style.transform='translateY(-2px)';" onmouseout="this.style.background='#6f42c1'; this.style.transform='translateY(0)';">ğŸ“Š JSON + Analiz</button>
                        <button onclick="exportLogs(${fileId}, 'xml', true)" style="padding: 10px 20px; background: #e83e8c; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 500; transition: all 0.3s;" onmouseover="this.style.background='#d91a72'; this.style.transform='translateY(-2px)';" onmouseout="this.style.background='#e83e8c'; this.style.transform='translateY(0)';">ğŸ“ˆ XML + Analiz</button>
                        <button onclick="loadTimeline(${fileId})" style="padding: 10px 20px; background: #fd7e14; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 500; transition: all 0.3s;" onmouseover="this.style.background='#e66a00'; this.style.transform='translateY(-2px)';" onmouseout="this.style.background='#fd7e14'; this.style.transform='translateY(0)';">â±ï¸ Timeline GÃ¶rÃ¼nÃ¼mÃ¼</button>
                    </div>
                `;
                document.querySelector('.content').appendChild(exportDiv);

                // En sÄ±k hatalar
                if (analysis.top_errors && analysis.top_errors.length > 0) {
                    const errorsDiv = document.createElement('div');
                    errorsDiv.className = 'chart-container';
                    errorsDiv.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <h3 style="color: var(--text-primary); margin: 0;">En SÄ±k Tekrar Eden Hatalar</h3>
                            <button onclick="loadPatternDetection(${fileId})" style="padding: 8px 15px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 12px; font-weight: 500;">ğŸ” Pattern Tespit Et</button>
                        </div>
                        ${analysis.top_errors.slice(0, 5).map((err, idx) => `
                            <div style="padding: 10px; margin: 5px 0; background: var(--error-bg); color: var(--error-text); border-radius: 5px;">
                                <strong>${idx + 1}. ${err.message.substring(0, 100)}</strong><br>
                                <small>${err.count} kez (${err.percentage}%)</small>
                            </div>
                        `).join('')}
                    `;
                    document.querySelector('.content').appendChild(errorsDiv);
                } else {
                    // Hata yoksa bile pattern detection butonu gÃ¶ster
                    const errorsDiv = document.createElement('div');
                    errorsDiv.className = 'chart-container';
                    errorsDiv.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <h3 style="color: var(--text-primary); margin: 0;">Pattern Detection</h3>
                            <button onclick="loadPatternDetection(${fileId})" style="padding: 8px 15px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 12px; font-weight: 500;">ğŸ” Pattern Tespit Et</button>
                        </div>
                    `;
                    document.querySelector('.content').appendChild(errorsDiv);
                }

                // AI yorumu
                if (analysis.ai_comment) {
                    const aiDiv = document.createElement('div');
                    aiDiv.className = 'chart-container';
                    aiDiv.innerHTML = `
                        <h3 style="color: var(--text-primary);">ğŸ¤– AI Analiz Yorumu</h3>
                        <p style="color: var(--text-secondary);">${analysis.ai_comment}</p>
                        ${analysis.ai_suggestions ? `
                            <h4 style="color: var(--text-primary);">Ã–neriler:</h4>
                            <ul style="color: var(--text-secondary);">
                                ${analysis.ai_suggestions.recommendations ? 
                                    analysis.ai_suggestions.recommendations.map(r => `<li>${r}</li>`).join('') : ''}
                            </ul>
                        ` : ''}
                    `;
                    document.querySelector('.content').appendChild(aiDiv);
                }

            } catch (error) {
                console.error('Analiz yÃ¼kleme hatasÄ±:', error);
                alert('Analiz yÃ¼klenirken hata oluÅŸtu!');
            }
        }

        // Dosya sil
        let deleteFileId = null;
        
        async function deleteFile(fileId) {
            deleteFileId = fileId;
            
            // Dosya bilgilerini al
            try {
                const response = await fetch(`${API_BASE}/logs/`);
                const files = await response.json();
                const file = files.find(f => f.id === fileId);
                
                if (file) {
                    document.getElementById('deleteFileName').textContent = file.filename;
                    document.getElementById('deleteFileInfo').innerHTML = `
                        SatÄ±r SayÄ±sÄ±: <strong>${file.total_lines}</strong><br>
                        Dosya Boyutu: <strong>${(file.file_size / 1024).toFixed(2)} KB</strong><br>
                        YÃ¼klenme Tarihi: <strong>${new Date(file.uploaded_at).toLocaleString('tr-TR')}</strong><br>
                        Durum: <strong>${file.status}</strong>
                    `;
                } else {
                    document.getElementById('deleteFileName').textContent = 'Bu dosya';
                    document.getElementById('deleteFileInfo').textContent = 'Dosya bilgileri alÄ±namadÄ±';
                }
            } catch (error) {
                document.getElementById('deleteFileName').textContent = 'Bu dosya';
                document.getElementById('deleteFileInfo').textContent = 'Dosya bilgileri alÄ±namadÄ±';
            }
            
            // Modal'Ä± gÃ¶ster
            const modal = document.getElementById('deleteFileConfirmModal');
            if (modal) {
                modal.style.display = 'flex';
            }
        }
        
        function closeDeleteFileConfirmModal() {
            const modal = document.getElementById('deleteFileConfirmModal');
            if (modal) {
                modal.style.display = 'none';
            }
            deleteFileId = null;
        }
        
        async function confirmDeleteFile() {
            if (!deleteFileId) return;
            
            const fileId = deleteFileId;
            closeDeleteFileConfirmModal();
            
            try {
                const response = await fetch(`${API_BASE}/logs/${fileId}`, {
                    method: 'DELETE'
                });

                if (response.ok) {
                    loadFiles();
                    loadDashboard();
                    loadFavorites();
                    showNotification('Dosya baÅŸarÄ±yla silindi', 'success');
                } else {
                    throw new Error('Silme hatasÄ±');
                }
            } catch (error) {
                console.error('Dosya silme hatasÄ±:', error);
                showNotification('Dosya silinirken hata oluÅŸtu!', 'error');
            }
        }

        // ========== FAVORITES ==========
        async function loadFavorites() {
            try {
                const response = await fetch(`${API_BASE}/favorites`, {
                    headers: getAuthHeaders()
                });
                if (!response.ok) return;
                
                const favorites = await response.json();
                const favoritesList = document.getElementById('favoritesList');
                const favoritesEmpty = document.getElementById('favoritesEmpty');
                
                favoritesList.innerHTML = '';
                
                if (favorites.length === 0) {
                    favoritesEmpty.style.display = 'block';
                    favoritesList.style.display = 'none';
                } else {
                    favoritesEmpty.style.display = 'none';
                    favoritesList.style.display = 'grid';
                    
                    favorites.forEach(fav => {
                        const favDiv = document.createElement('div');
                        favDiv.style.cssText = 'background: var(--card-bg); padding: 15px; border-radius: 8px; border: 1px solid var(--border-color);';
                        favDiv.innerHTML = `
                            <h4 style="color: var(--text-primary); margin-bottom: 10px;">â­ ${fav.log_file.filename}</h4>
                            <p style="color: var(--text-secondary); font-size: 0.9em; margin-bottom: 10px;">${fav.log_file.total_lines} satÄ±r</p>
                            ${fav.notes ? `<p style="color: var(--text-secondary); font-size: 0.85em; font-style: italic;">${fav.notes}</p>` : ''}
                            <div style="margin-top: 10px; display: flex; gap: 5px;">
                                <button onclick="showAnalysis(${fav.log_file_id})" style="flex: 1; padding: 5px; background: #667eea; color: white; border: none; border-radius: 3px; cursor: pointer;">Analiz</button>
                                <button onclick="removeFavorite(${fav.id})" style="padding: 5px 10px; background: #dc3545; color: white; border: none; border-radius: 3px; cursor: pointer;">KaldÄ±r</button>
                            </div>
                        `;
                        favoritesList.appendChild(favDiv);
                    });
                }
            } catch (error) {
                console.error('Favoriler yÃ¼klenirken hata:', error);
            }
        }

        async function toggleFavorite(fileId, isFavorite) {
            try {
                if (isFavorite) {
                    // Favoriden kaldÄ±r
                    const checkRes = await fetch(`${API_BASE}/favorites/check/${fileId}`);
                    const checkData = await checkRes.json();
                    if (checkData.is_favorite && checkData.favorite_id) {
                        await fetch(`${API_BASE}/favorites/${checkData.favorite_id}`, { method: 'DELETE' });
                    }
                } else {
                    // Favoriye ekle
                    await fetch(`${API_BASE}/favorites`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ log_file_id: fileId })
                    });
                }
                loadFiles();
                loadFavorites();
            } catch (error) {
                console.error('Favori iÅŸlemi hatasÄ±:', error);
            }
        }

        async function removeFavorite(favoriteId) {
            try {
                await fetch(`${API_BASE}/favorites/${favoriteId}`, { method: 'DELETE' });
                loadFavorites();
                loadFiles();
            } catch (error) {
                console.error('Favori kaldÄ±rma hatasÄ±:', error);
            }
        }

        // ========== ALERTS ==========
        async function loadAlerts() {
            try {
                const response = await fetch(`${API_BASE}/alerts`, {
                    headers: getAuthHeaders()
                });
                if (!response.ok) return;
                
                const alerts = await response.json();
                const alertsList = document.getElementById('alertsList');
                const alertsEmpty = document.getElementById('alertsEmpty');
                
                alertsList.innerHTML = '';
                
                if (alerts.length === 0) {
                    alertsEmpty.style.display = 'block';
                    alertsList.style.display = 'none';
                } else {
                    alertsEmpty.style.display = 'none';
                    alertsList.style.display = 'grid';
                    
                    alerts.forEach(alert => {
                        const alertDiv = document.createElement('div');
                        alertDiv.style.cssText = 'background: var(--card-bg); padding: 15px; border-radius: 8px; border: 1px solid var(--border-color);';
                        alertDiv.innerHTML = `
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                                <h4 style="color: var(--text-primary); margin: 0;">ğŸš¨ ${alert.name}</h4>
                                <span style="padding: 3px 8px; background: ${alert.is_active === 'active' ? '#28a745' : '#6c757d'}; color: white; border-radius: 3px; font-size: 0.8em;">
                                    ${alert.is_active === 'active' ? 'Aktif' : 'Pasif'}
                                </span>
                            </div>
                            <p style="color: var(--text-secondary); font-size: 0.9em; margin-bottom: 10px;">${alert.description || 'AÃ§Ä±klama yok'}</p>
                            <p style="color: var(--text-secondary); font-size: 0.85em; margin-bottom: 10px;">
                                <strong>KoÅŸul:</strong> ${alert.condition_type}<br>
                                <strong>Bildirim:</strong> ${alert.notification_channels.join(', ')}<br>
                                <strong>Tetiklendi:</strong> ${alert.trigger_count} kez
                            </p>
                            <div style="display: flex; gap: 5px; margin-top: 10px;">
                                <button onclick="testAlert(${alert.id})" style="flex: 1; padding: 5px; background: #17a2b8; color: white; border: none; border-radius: 3px; cursor: pointer;">Test</button>
                                <button onclick="deleteAlert(${alert.id})" style="padding: 5px 10px; background: #dc3545; color: white; border: none; border-radius: 3px; cursor: pointer;">Sil</button>
                            </div>
                        `;
                        alertsList.appendChild(alertDiv);
                    });
                }
            } catch (error) {
                console.error('Alertler yÃ¼klenirken hata:', error);
            }
        }

        function showCreateAlertModal() {
            const modal = document.getElementById('createAlertModal');
            if (modal) {
                modal.style.display = 'flex';
                // Form'u temizle
                document.getElementById('alertName').value = '';
                document.getElementById('alertDescription').value = '';
                document.getElementById('alertConditionType').value = '';
                document.getElementById('alertThreshold').value = '';
                document.getElementById('alertTimeWindow').value = '300';
                document.getElementById('alertLogLevel').value = 'ERROR';
                document.getElementById('alertPattern').value = '';
                document.getElementById('alertChannelEmail').checked = false;
                document.getElementById('alertChannelSlack').checked = false;
                document.getElementById('alertChannelWebhook').checked = false;
                document.getElementById('alertEmails').value = '';
                document.getElementById('alertSlackWebhook').value = '';
                document.getElementById('alertWebhookUrl').value = '';
                document.getElementById('alertConditionFields').style.display = 'none';
                document.getElementById('alertEmailField').style.display = 'none';
                document.getElementById('alertSlackField').style.display = 'none';
                document.getElementById('alertWebhookField').style.display = 'none';
            }
        }
        
        function updateAlertConditionFields() {
            const conditionType = document.getElementById('alertConditionType').value;
            const conditionFields = document.getElementById('alertConditionFields');
            const patternField = document.getElementById('alertPatternField');
            const logLevelField = document.getElementById('alertLogLevelField');
            
            if (conditionType) {
                conditionFields.style.display = 'block';
                if (conditionType === 'pattern_match') {
                    patternField.style.display = 'block';
                    logLevelField.style.display = 'none';
                } else {
                    patternField.style.display = 'none';
                    logLevelField.style.display = 'block';
                }
            } else {
                conditionFields.style.display = 'none';
            }
        }
        
        function updateAlertChannelFields() {
            const emailChecked = document.getElementById('alertChannelEmail').checked;
            const slackChecked = document.getElementById('alertChannelSlack').checked;
            const webhookChecked = document.getElementById('alertChannelWebhook').checked;
            
            document.getElementById('alertEmailField').style.display = emailChecked ? 'block' : 'none';
            document.getElementById('alertSlackField').style.display = slackChecked ? 'block' : 'none';
            document.getElementById('alertWebhookField').style.display = webhookChecked ? 'block' : 'none';
        }
        
        
        function submitCreateAlert() {
            const name = document.getElementById('alertName').value.trim();
            const description = document.getElementById('alertDescription').value.trim();
            const conditionType = document.getElementById('alertConditionType').value;
            const threshold = document.getElementById('alertThreshold').value;
            const timeWindow = document.getElementById('alertTimeWindow').value || '300';
            const logLevel = document.getElementById('alertLogLevel').value;
            const pattern = document.getElementById('alertPattern').value.trim();
            
            // Validasyon
            if (!name) {
                showNotification('LÃ¼tfen alert adÄ± girin!', 'error');
                document.getElementById('alertName').focus();
                return;
            }
            
            if (!conditionType) {
                showNotification('LÃ¼tfen koÅŸul tipi seÃ§in!', 'error');
                document.getElementById('alertConditionType').focus();
                return;
            }
            
            if (!threshold || parseInt(threshold) < 1) {
                showNotification('LÃ¼tfen geÃ§erli bir threshold deÄŸeri girin!', 'error');
                document.getElementById('alertThreshold').focus();
                return;
            }
            
            // Bildirim kanallarÄ±nÄ± topla
            const channels = [];
            const recipients = {};
            
            if (document.getElementById('alertChannelEmail').checked) {
                const emails = document.getElementById('alertEmails').value.trim();
                if (emails) {
                    channels.push('email');
                    recipients.email = emails.split(',').map(e => e.trim()).filter(e => e);
                } else {
                    showNotification('Email seÃ§ildi ancak email adresi girilmedi!', 'error');
                    return;
                }
            }
            
            if (document.getElementById('alertChannelSlack').checked) {
                const slackWebhook = document.getElementById('alertSlackWebhook').value.trim();
                if (slackWebhook) {
                    channels.push('slack');
                    recipients.slack_webhook = slackWebhook;
                } else {
                    showNotification('Slack seÃ§ildi ancak webhook URL girilmedi!', 'error');
                    return;
                }
            }
            
            if (document.getElementById('alertChannelWebhook').checked) {
                const webhookUrl = document.getElementById('alertWebhookUrl').value.trim();
                if (webhookUrl) {
                    channels.push('webhook');
                    recipients.webhook_url = webhookUrl;
                } else {
                    showNotification('Webhook seÃ§ildi ancak URL girilmedi!', 'error');
                    return;
                }
            }
            
            if (channels.length === 0) {
                showNotification('LÃ¼tfen en az bir bildirim kanalÄ± seÃ§in!', 'error');
                return;
            }
            
            // Condition params oluÅŸtur
            const conditionParams = {
                threshold: parseInt(threshold),
                time_window: parseInt(timeWindow)
            };
            
            if (conditionType === 'pattern_match') {
                if (!pattern) {
                    showNotification('Pattern eÅŸleÅŸmesi iÃ§in pattern girin!', 'error');
                    document.getElementById('alertPattern').focus();
                    return;
                }
                conditionParams.pattern = pattern;
            } else {
                conditionParams.log_level = logLevel;
            }
            
            // Alert oluÅŸtur
            createAlert({
                name,
                description,
                condition_type: conditionType,
                condition_params: conditionParams,
                notification_channels: channels,
                recipients: recipients
            });
            
            closeCreateAlertModal();
        }

        async function createAlert(alertData) {
            try {
                const response = await fetch(`${API_BASE}/alerts`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(alertData)
                });
                
                if (response.ok) {
                    loadAlerts();
                    showNotification('Alert kuralÄ± oluÅŸturuldu!', 'success');
                } else {
                    throw new Error('Alert oluÅŸturma hatasÄ±');
                }
            } catch (error) {
                console.error('Alert oluÅŸturma hatasÄ±:', error);
                showNotification('Alert oluÅŸturulurken hata oluÅŸtu!', 'error');
            }
        }

        async function testAlert(alertId) {
            try {
                const response = await fetch(`${API_BASE}/alerts/${alertId}/test`, { method: 'POST' });
                const result = await response.json();
                showNotification(result.triggered ? 'Alert tetiklendi!' : 'KoÅŸul saÄŸlanmadÄ±', result.triggered ? 'success' : 'info');
            } catch (error) {
                console.error('Alert test hatasÄ±:', error);
            }
        }

        let deleteAlertId = null;
        
        async function deleteAlert(alertId) {
            deleteAlertId = alertId;
            
            // Alert bilgilerini al
            try {
                const response = await fetch(`${API_BASE}/alerts/${alertId}`);
                if (response.ok) {
                    const alert = await response.json();
                    document.getElementById('deleteAlertName').textContent = alert.name;
                } else {
                    document.getElementById('deleteAlertName').textContent = 'bu alert kuralÄ±';
                }
            } catch (error) {
                document.getElementById('deleteAlertName').textContent = 'bu alert kuralÄ±';
            }
            
            // Modal'Ä± gÃ¶ster
            const modal = document.getElementById('deleteAlertConfirmModal');
            if (modal) {
                modal.style.display = 'flex';
            }
        }
        
        function closeDeleteAlertConfirmModal() {
            const modal = document.getElementById('deleteAlertConfirmModal');
            if (modal) {
                modal.style.display = 'none';
            }
            deleteAlertId = null;
        }
        
        async function confirmDeleteAlert() {
            if (!deleteAlertId) return;
            
            const alertId = deleteAlertId;
            closeDeleteAlertConfirmModal();
            
            try {
                const response = await fetch(`${API_BASE}/alerts/${alertId}`, { method: 'DELETE' });
                
                if (response.ok) {
                    loadAlerts();
                    showNotification('Alert kuralÄ± silindi', 'success');
                } else {
                    throw new Error('Silme hatasÄ±');
                }
            } catch (error) {
                console.error('Alert silme hatasÄ±:', error);
                showNotification('Alert silinirken hata oluÅŸtu!', 'error');
            }
        }

        function closeCreateAlertModal() {
            const modal = document.getElementById('createAlertModal');
            if (modal) {
                modal.style.display = 'none';
            }
        }

        // ========== COMPARISON ==========
        function updateComparisonSelects() {
            fetch(`${API_BASE}/logs`).then(r => r.json()).then(files => {
                const select1 = document.getElementById('compareFile1');
                const select2 = document.getElementById('compareFile2');
                
                [select1, select2].forEach(select => {
                    if (!select) return;
                    const currentValue = select.value;
                    select.innerHTML = '<option value="">Dosya SeÃ§in</option>';
                    files.forEach(file => {
                        const option = document.createElement('option');
                        option.value = file.id;
                        option.textContent = file.filename;
                        select.appendChild(option);
                    });
                    if (currentValue) select.value = currentValue;
                });
            });
        }

        function showComparisonForFile(fileId) {
            const modal = document.getElementById('comparisonModal');
            if (modal) {
                modal.style.display = 'flex';
                
                // Dosya listesini yÃ¼kle
                fetch(`${API_BASE}/logs`).then(r => r.json()).then(files => {
                    const select1 = document.getElementById('modalCompareFile1');
                    const select2 = document.getElementById('modalCompareFile2');
                    
                    [select1, select2].forEach(select => {
                        if (!select) return;
                        const currentValue = select.value;
                        select.innerHTML = '<option value="">Dosya SeÃ§in</option>';
                        files.forEach(file => {
                            const option = document.createElement('option');
                            option.value = file.id;
                            option.textContent = `${file.filename} (${file.total_lines} satÄ±r)`;
                            select.appendChild(option);
                        });
                        if (currentValue) select.value = currentValue;
                    });
                    
                    // Ä°lk dosyayÄ± seÃ§ili yap
                    if (fileId && select1) {
                        select1.value = fileId;
                    }
                });
            }
        }
        
        function closeComparisonModal() {
            const modal = document.getElementById('comparisonModal');
            if (modal) {
                modal.style.display = 'none';
            }
        }
        
        async function submitComparison() {
            const file1 = document.getElementById('modalCompareFile1').value;
            const file2 = document.getElementById('modalCompareFile2').value;
            
            if (!file1 || !file2) {
                showNotification('LÃ¼tfen iki dosya seÃ§in!', 'error');
                return;
            }
            
            if (file1 === file2) {
                showNotification('AynÄ± dosyayÄ± seÃ§emezsiniz!', 'error');
                return;
            }
            
            closeComparisonModal();
            
            try {
                const response = await fetch(`${API_BASE}/analysis/compare`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ file_id_1: parseInt(file1), file_id_2: parseInt(file2) })
                });
                
                if (!response.ok) {
                    throw new Error('KarÅŸÄ±laÅŸtÄ±rma hatasÄ±');
                }
                
                const comparison = await response.json();
                
                // Comparison section'Ä± gÃ¶ster ve sonuÃ§larÄ± gÃ¶ster
                showSection('comparison');
                document.getElementById('compareFile1').value = file1;
                document.getElementById('compareFile2').value = file2;
                displayComparisonResults(comparison);
            } catch (error) {
                console.error('KarÅŸÄ±laÅŸtÄ±rma hatasÄ±:', error);
                showNotification('KarÅŸÄ±laÅŸtÄ±rma yapÄ±lÄ±rken hata oluÅŸtu!', 'error');
            }
        }

        async function compareLogs() {
            const file1 = document.getElementById('compareFile1').value;
            const file2 = document.getElementById('compareFile2').value;
            
            if (!file1 || !file2) {
                alert('LÃ¼tfen iki dosya seÃ§in!');
                return;
            }
            
            if (file1 === file2) {
                alert('AynÄ± dosyayÄ± seÃ§emezsiniz!');
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/analysis/compare`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ file_id_1: parseInt(file1), file_id_2: parseInt(file2) })
                });
                
                const comparison = await response.json();
                displayComparisonResults(comparison);
            } catch (error) {
                console.error('KarÅŸÄ±laÅŸtÄ±rma hatasÄ±:', error);
                alert('KarÅŸÄ±laÅŸtÄ±rma yapÄ±lÄ±rken hata oluÅŸtu!');
            }
        }

        function displayComparisonResults(comparison) {
            const resultsDiv = document.getElementById('comparisonResults');
            resultsDiv.style.display = 'block';
            
            resultsDiv.innerHTML = `
                <div style="background: var(--card-bg); padding: 20px; border-radius: 8px; margin-bottom: 15px;">
                    <h3 style="color: var(--text-primary); margin-bottom: 15px;">ğŸ“Š KarÅŸÄ±laÅŸtÄ±rma SonuÃ§larÄ±</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                        <div style="background: var(--bg-tertiary); padding: 15px; border-radius: 5px;">
                            <strong style="color: var(--text-primary);">Dosya 1:</strong><br>
                            <span style="color: var(--text-secondary);">${comparison.file_1.filename}</span>
                        </div>
                        <div style="background: var(--bg-tertiary); padding: 15px; border-radius: 5px;">
                            <strong style="color: var(--text-primary);">Dosya 2:</strong><br>
                            <span style="color: var(--text-secondary);">${comparison.file_2.filename}</span>
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px;">
                        <div style="background: ${comparison.differences.total_lines_diff >= 0 ? '#d4edda' : '#f8d7da'}; color: ${comparison.differences.total_lines_diff >= 0 ? '#155724' : '#721c24'}; padding: 10px; border-radius: 5px;">
                            <strong style="color: ${comparison.differences.total_lines_diff >= 0 ? '#155724' : '#721c24'};">SatÄ±r FarkÄ±:</strong> ${comparison.differences.total_lines_diff > 0 ? '+' : ''}${comparison.differences.total_lines_diff}
                        </div>
                        <div style="background: ${comparison.differences.error_count_diff >= 0 ? '#f8d7da' : '#d4edda'}; color: ${comparison.differences.error_count_diff >= 0 ? '#721c24' : '#155724'}; padding: 10px; border-radius: 5px;">
                            <strong style="color: ${comparison.differences.error_count_diff >= 0 ? '#721c24' : '#155724'};">Hata FarkÄ±:</strong> ${comparison.differences.error_count_diff > 0 ? '+' : ''}${comparison.differences.error_count_diff}
                        </div>
                        <div style="background: var(--bg-tertiary); color: var(--text-primary); padding: 10px; border-radius: 5px;">
                            <strong style="color: var(--text-primary);">Ortak Hatalar:</strong> ${comparison.differences.common_errors_count}
                        </div>
                    </div>
                </div>
                
                ${comparison.common_errors.length > 0 ? `
                    <div style="background: var(--card-bg); padding: 20px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: var(--text-primary); margin-bottom: 10px;">Ortak Hatalar</h4>
                        ${comparison.common_errors.slice(0, 10).map(err => `
                            <div style="padding: 10px; margin: 5px 0; background: var(--bg-tertiary); border-radius: 5px;">
                                <strong>${err.message.substring(0, 80)}...</strong><br>
                                <small>Dosya 1: ${err.count_in_file_1} kez | Dosya 2: ${err.count_in_file_2} kez</small>
                            </div>
                        `).join('')}
                    </div>
                ` : ''}
            `;
            
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }

        function closeComparisonResults() {
            document.getElementById('comparisonResults').style.display = 'none';
        }

        // ========== COMMENTS ==========
        async function addCommentToEntry(entryId) {
            const comment = prompt('Yorum ekle:');
            if (!comment) return;
            
            try {
                await fetch(`${API_BASE}/entries/${entryId}/comments`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ comment, author: 'User' })
                });
                showNotification('Yorum eklendi!', 'success');
            } catch (error) {
                console.error('Yorum ekleme hatasÄ±:', error);
            }
        }

        // ========== DASHBOARD WIDGETS ==========
        let widgetCustomizationMode = false;
        let draggedWidget = null;
        
        function toggleWidgetCustomization() {
            widgetCustomizationMode = !widgetCustomizationMode;
            const grid = document.getElementById('chartsGrid');
            if (grid) {
                if (widgetCustomizationMode) {
                    grid.classList.add('widget-customization-mode');
                    showNotification('Widget dÃ¼zenleme modu aktif. Widget\'larÄ± sÃ¼rÃ¼kleyerek yeniden dÃ¼zenleyebilirsiniz.', 'info');
                } else {
                    grid.classList.remove('widget-customization-mode');
                    saveWidgetLayout();
                    showNotification('Widget dÃ¼zenleme modu kapatÄ±ldÄ±. DeÄŸiÅŸiklikler kaydedildi.', 'success');
                }
            }
        }
        
        function toggleWidget(widgetId) {
            const widget = document.querySelector(`[data-widget-id="${widgetId}"]`);
            if (widget) {
                widget.classList.toggle('widget-hidden');
                saveWidgetVisibility();
            }
        }
        
        function saveWidgetLayout() {
            const widgets = Array.from(document.querySelectorAll('.draggable-widget'));
            const layout = widgets.map((widget, index) => ({
                id: widget.getAttribute('data-widget-id'),
                order: index
            }));
            localStorage.setItem('dashboardWidgetLayout', JSON.stringify(layout));
        }
        
        function loadWidgetLayout() {
            const saved = localStorage.getItem('dashboardWidgetLayout');
            if (saved) {
                try {
                    const layout = JSON.parse(saved);
                    const grid = document.getElementById('chartsGrid');
                    if (grid) {
                        layout.forEach(item => {
                            const widget = document.querySelector(`[data-widget-id="${item.id}"]`);
                            if (widget) {
                                grid.appendChild(widget);
                            }
                        });
                    }
                } catch (e) {
                    console.error('Widget layout yÃ¼kleme hatasÄ±:', e);
                }
            }
            
            // Widget visibility
            const savedVisibility = localStorage.getItem('dashboardWidgetVisibility');
            if (savedVisibility) {
                try {
                    const visibility = JSON.parse(savedVisibility);
                    Object.keys(visibility).forEach(widgetId => {
                        if (!visibility[widgetId]) {
                            const widget = document.querySelector(`[data-widget-id="${widgetId}"]`);
                            if (widget) {
                                widget.classList.add('widget-hidden');
                            }
                        }
                    });
                } catch (e) {
                    console.error('Widget visibility yÃ¼kleme hatasÄ±:', e);
                }
            }
        }
        
        function saveWidgetVisibility() {
            const widgets = document.querySelectorAll('.draggable-widget');
            const visibility = {};
            widgets.forEach(widget => {
                const id = widget.getAttribute('data-widget-id');
                visibility[id] = !widget.classList.contains('widget-hidden');
            });
            localStorage.setItem('dashboardWidgetVisibility', JSON.stringify(visibility));
        }
        
        // Drag & Drop handlers
        document.addEventListener('DOMContentLoaded', function() {
            const grid = document.getElementById('chartsGrid');
            if (grid) {
                grid.addEventListener('dragstart', function(e) {
                    if (e.target.classList.contains('draggable-widget')) {
                        draggedWidget = e.target;
                        e.target.classList.add('dragging');
                        e.dataTransfer.effectAllowed = 'move';
                        e.dataTransfer.setData('text/html', e.target.innerHTML);
                    }
                });
                
                grid.addEventListener('dragend', function(e) {
                    if (e.target.classList.contains('draggable-widget')) {
                        e.target.classList.remove('dragging');
                        draggedWidget = null;
                    }
                });
                
                grid.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    e.dataTransfer.dropEffect = 'move';
                    
                    const afterElement = getDragAfterElement(grid, e.clientX);
                    const dragging = document.querySelector('.dragging');
                    if (dragging && afterElement == null) {
                        grid.appendChild(dragging);
                    } else if (dragging && afterElement) {
                        grid.insertBefore(dragging, afterElement);
                    }
                });
                
                grid.addEventListener('drop', function(e) {
                    e.preventDefault();
                    if (draggedWidget) {
                        saveWidgetLayout();
                    }
                });
            }
        });
        
        function getDragAfterElement(container, x) {
            const draggableElements = [...container.querySelectorAll('.draggable-widget:not(.dragging)')];
            
            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = x - box.left - box.width / 2;
                
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }

        // ========== SEARCH HISTORY ==========
        async function saveSearchHistory(searchQuery, searchParams) {
            try {
                await fetch(`${API_BASE}/search-history`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        search_query: searchQuery,
                        search_params: searchParams,
                        result_count: 0 // WebSocket'ten sonuÃ§ sayÄ±sÄ±nÄ± alamÄ±yoruz, 0 bÄ±rakÄ±yoruz
                    })
                });
            } catch (error) {
                console.error('Arama geÃ§miÅŸi kaydetme hatasÄ±:', error);
            }
        }
        
        async function loadSearchHistory() {
            try {
                const response = await fetch(`${API_BASE}/search-history?limit=10`);
                const history = await response.json();
                
                const dropdown = document.getElementById('searchHistoryDropdown');
                const list = document.getElementById('searchHistoryList');
                
                if (history.length === 0) {
                    list.innerHTML = '<div style="padding: 15px; text-align: center; color: var(--text-secondary); font-size: 12px;">Arama geÃ§miÅŸi yok</div>';
                    return;
                }
                
                list.innerHTML = history.map(item => `
                    <div onclick="useSearchHistory('${item.search_query.replace(/'/g, "\\'")}', ${JSON.stringify(item.search_params || {})})" 
                         style="padding: 10px; cursor: pointer; border-bottom: 1px solid var(--border-color); transition: background 0.2s;"
                         onmouseover="this.style.background='var(--bg-tertiary)'"
                         onmouseout="this.style.background='transparent'">
                        <div style="color: var(--text-primary); font-size: 13px; font-weight: 500; margin-bottom: 3px;">${item.search_query}</div>
                        <div style="color: var(--text-secondary); font-size: 11px;">${new Date(item.searched_at).toLocaleString('tr-TR')}</div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Arama geÃ§miÅŸi yÃ¼kleme hatasÄ±:', error);
            }
        }
        
        function toggleSearchHistoryDropdown() {
            const dropdown = document.getElementById('searchHistoryDropdown');
            if (dropdown) {
                dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';
                if (dropdown.style.display === 'block') {
                    loadSearchHistory();
                }
            }
        }
        
        function useSearchHistory(searchQuery, searchParams) {
            document.getElementById('streamSearch').value = searchQuery;
            if (searchParams.file_id) {
                document.getElementById('streamFileSelect').value = searchParams.file_id;
            }
            if (searchParams.log_level) {
                document.getElementById('streamLevelFilter').value = searchParams.log_level;
            }
            document.getElementById('searchHistoryDropdown').style.display = 'none';
        }
        
        async function clearSearchHistory() {
            if (!confirm('TÃ¼m arama geÃ§miÅŸini temizlemek istediÄŸinizden emin misiniz?')) {
                return;
            }
            
            try {
                await fetch(`${API_BASE}/search-history`, { method: 'DELETE' });
                loadSearchHistory();
                showNotification('Arama geÃ§miÅŸi temizlendi', 'success');
            } catch (error) {
                console.error('Arama geÃ§miÅŸi temizleme hatasÄ±:', error);
                showNotification('Arama geÃ§miÅŸi temizlenirken hata oluÅŸtu!', 'error');
            }
        }
        
        // Dropdown dÄ±ÅŸÄ±na tÄ±klandÄ±ÄŸÄ±nda kapat
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('searchHistoryDropdown');
            const searchInput = document.getElementById('streamSearch');
            const historyButton = event.target.closest('button[onclick*="toggleSearchHistoryDropdown"]');
            
            if (dropdown && !dropdown.contains(event.target) && 
                !searchInput.contains(event.target) && 
                !historyButton) {
                dropdown.style.display = 'none';
            }
        });

        // ========== EXPORT ==========
        async function exportLogs(fileId, format, includeAnalysis) {
            try {
                const url = `${API_BASE}/export/${fileId}/${format}?include_analysis=${includeAnalysis}`;
                const response = await fetch(url);
                
                if (!response.ok) {
                    throw new Error('Export hatasÄ±');
                }
                
                const blob = await response.blob();
                const downloadUrl = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = downloadUrl;
                a.download = `log_export_${fileId}.${format}`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(downloadUrl);
                
                showNotification(`${format.toUpperCase()} export baÅŸarÄ±lÄ±!`, 'success');
            } catch (error) {
                console.error('Export hatasÄ±:', error);
                showNotification('Export yapÄ±lÄ±rken hata oluÅŸtu!', 'error');
            }
        }
        
        // ========== PATTERN DETECTION ==========
        async function loadPatternDetection(fileId) {
            try {
                showNotification('Pattern detection baÅŸlatÄ±lÄ±yor...', 'info');
                
                const response = await fetch(`${API_BASE}/analysis/${fileId}/patterns?min_similarity=0.7`);
                if (!response.ok) {
                    throw new Error('Pattern detection hatasÄ±');
                }
                
                const patterns = await response.json();
                
                // Pattern detection sonuÃ§larÄ±nÄ± gÃ¶ster
                displayPatternDetection(patterns, fileId);
                
                showNotification(`${patterns.total_patterns} pattern ve ${patterns.total_groups} benzer hata grubu bulundu!`, 'success');
            } catch (error) {
                console.error('Pattern detection hatasÄ±:', error);
                showNotification('Pattern detection yapÄ±lÄ±rken hata oluÅŸtu!', 'error');
            }
        }
        
        function displayPatternDetection(patterns, fileId) {
            // Mevcut pattern detection div'ini kontrol et
            let patternDiv = document.getElementById('patternDetectionResults');
            if (!patternDiv) {
                patternDiv = document.createElement('div');
                patternDiv.id = 'patternDetectionResults';
                patternDiv.className = 'chart-container';
                document.querySelector('.content').appendChild(patternDiv);
            }
            
            patternDiv.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3 style="color: var(--text-primary); margin: 0;">ğŸ” Pattern Detection SonuÃ§larÄ±</h3>
                    <button onclick="document.getElementById('patternDetectionResults').remove()" style="background: transparent; border: none; color: var(--text-secondary); cursor: pointer; font-size: 20px;">âœ•</button>
                </div>
                
                <div style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px;">
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: bold; color: var(--accent-color);">${patterns.total_patterns}</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">Pattern</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: bold; color: var(--accent-color);">${patterns.total_groups}</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">Benzer Hata Grubu</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: bold; color: var(--accent-color);">${patterns.analyzed_logs || 0}</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">Analiz Edilen Log</div>
                        </div>
                    </div>
                </div>
                
                ${patterns.patterns && patterns.patterns.length > 0 ? `
                    <div style="margin-bottom: 20px;">
                        <h4 style="color: var(--text-primary); margin-bottom: 10px;">ğŸ“Š Tespit Edilen Pattern'ler</h4>
                        ${patterns.patterns.map(pattern => `
                            <div style="background: var(--card-bg); padding: 12px; border-radius: 6px; margin-bottom: 10px; border-left: 4px solid var(--accent-color);">
                                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px;">
                                    <strong style="color: var(--text-primary);">${pattern.pattern}</strong>
                                    <span style="background: var(--accent-color); color: white; padding: 3px 8px; border-radius: 12px; font-size: 11px; font-weight: 600;">${pattern.count} kez</span>
                                </div>
                                ${pattern.examples && pattern.examples.length > 0 ? `
                                    <div style="margin-top: 8px;">
                                        <small style="color: var(--text-secondary); font-weight: 600;">Ã–rnekler:</small>
                                        <div style="margin-top: 5px; display: flex; flex-wrap: wrap; gap: 5px;">
                                            ${pattern.examples.slice(0, 3).map(ex => {
                                                if (typeof ex === 'object' && ex.endpoint) {
                                                    return `<span style="background: var(--bg-tertiary); padding: 3px 8px; border-radius: 4px; font-size: 11px; color: var(--text-primary);">${ex.endpoint} (${ex.count}x)</span>`;
                                                } else if (typeof ex === 'object' && ex.code) {
                                                    return `<span style="background: var(--bg-tertiary); padding: 3px 8px; border-radius: 4px; font-size: 11px; color: var(--text-primary);">${ex.code} (${ex.count}x)</span>`;
                                                } else if (typeof ex === 'object' && ex.type) {
                                                    return `<span style="background: var(--bg-tertiary); padding: 3px 8px; border-radius: 4px; font-size: 11px; color: var(--text-primary);">${ex.type} (${ex.count}x)</span>`;
                                                } else {
                                                    return `<span style="background: var(--bg-tertiary); padding: 3px 8px; border-radius: 4px; font-size: 11px; color: var(--text-primary);">${String(ex).substring(0, 50)}</span>`;
                                                }
                                            }).join('')}
                                        </div>
                                    </div>
                                ` : ''}
                            </div>
                        `).join('')}
                    </div>
                ` : ''}
                
                ${patterns.groups && patterns.groups.length > 0 ? `
                    <div>
                        <h4 style="color: var(--text-primary); margin-bottom: 10px;">ğŸ”— Benzer Hata GruplarÄ±</h4>
                        ${patterns.groups.map(group => `
                            <div style="background: var(--card-bg); padding: 12px; border-radius: 6px; margin-bottom: 10px; border-left: 4px solid ${group.log_level === 'ERROR' ? '#e74c3c' : '#f39c12'}; cursor: pointer;" 
                                 onclick="showPatternGroupDetails(${fileId}, ${group.id})"
                                 onmouseover="this.style.background='var(--bg-tertiary)'"
                                 onmouseout="this.style.background='var(--card-bg)'">
                                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px;">
                                    <div style="flex: 1;">
                                        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 5px;">
                                            <span style="background: ${group.log_level === 'ERROR' ? '#e74c3c' : '#f39c12'}; color: white; padding: 2px 8px; border-radius: 3px; font-size: 10px; font-weight: 600;">${group.log_level}</span>
                                            <span style="background: var(--accent-color); color: white; padding: 2px 8px; border-radius: 12px; font-size: 11px; font-weight: 600;">${group.count} benzer hata</span>
                                        </div>
                                        <div style="color: var(--text-primary); font-size: 13px; line-height: 1.4;">${group.representative}</div>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                ` : ''}
            `;
            
            patternDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
        
        async function showPatternGroupDetails(fileId, groupId) {
            // Pattern group detaylarÄ±nÄ± gÃ¶ster (modal veya yeni section)
            showNotification('Pattern group detaylarÄ± yakÄ±nda eklenecek', 'info');
        }

        // ========== TIMELINE VIEW ==========
        let timelineChart = null;
        
        async function loadTimeline(fileId) {
            try {
                showNotification('Timeline yÃ¼kleniyor...', 'info');
                
                const groupBy = document.getElementById('timelineGroupBy') ? document.getElementById('timelineGroupBy').value : 'minute';
                const response = await fetch(`${API_BASE}/analysis/${fileId}/timeline?group_by=${groupBy}`);
                if (!response.ok) {
                    throw new Error('Timeline yÃ¼kleme hatasÄ±');
                }
                
                const timelineData = await response.json();
                displayTimeline(timelineData, fileId);
                
                showNotification('Timeline yÃ¼klendi!', 'success');
            } catch (error) {
                console.error('Timeline yÃ¼kleme hatasÄ±:', error);
                showNotification('Timeline yÃ¼klenirken hata oluÅŸtu!', 'error');
            }
        }
        
        function displayTimeline(timelineData, fileId) {
            // Mevcut timeline div'ini kontrol et
            let timelineDiv = document.getElementById('timelineResults');
            if (!timelineDiv) {
                timelineDiv = document.createElement('div');
                timelineDiv.id = 'timelineResults';
                timelineDiv.className = 'chart-container';
                document.querySelector('.content').appendChild(timelineDiv);
            }
            
            const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
            const textColor = isDark ? '#e0e0e0' : '#333';
            
            timelineDiv.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3 style="color: var(--text-primary); margin: 0;">â±ï¸ Timeline GÃ¶rÃ¼nÃ¼mÃ¼</h3>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <select id="timelineGroupBy" onchange="loadTimeline(${fileId})" style="padding: 5px 10px; border: 2px solid var(--border-color); border-radius: 5px; background: var(--input-bg); color: var(--text-primary);">
                            <option value="minute" selected>Dakika</option>
                            <option value="hour">Saat</option>
                            <option value="day">GÃ¼n</option>
                        </select>
                        <button onclick="document.getElementById('timelineResults').remove(); if(timelineChart) timelineChart.destroy();" style="background: transparent; border: none; color: var(--text-secondary); cursor: pointer; font-size: 20px;">âœ•</button>
                    </div>
                </div>
                
                <div style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px;">
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: bold; color: var(--accent-color);">${timelineData.total_events || 0}</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">Toplam Olay</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: bold; color: var(--accent-color);">${timelineData.time_range.start ? new Date(timelineData.time_range.start).toLocaleString('tr-TR') : 'N/A'}</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">BaÅŸlangÄ±Ã§</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: bold; color: var(--accent-color);">${timelineData.time_range.end ? new Date(timelineData.time_range.end).toLocaleString('tr-TR') : 'N/A'}</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">BitiÅŸ</div>
                        </div>
                    </div>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <canvas id="timelineChart" style="max-height: 400px;"></canvas>
                </div>
                
                ${timelineData.relationships && timelineData.relationships.length > 0 ? `
                    <div style="margin-top: 20px;">
                        <h4 style="color: var(--text-primary); margin-bottom: 10px;">ğŸ”— Olay Ä°liÅŸkileri</h4>
                        ${timelineData.relationships.slice(0, 10).map(rel => `
                            <div style="background: var(--card-bg); padding: 12px; border-radius: 6px; margin-bottom: 10px; border-left: 4px solid var(--accent-color);">
                                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px;">
                                    <strong style="color: var(--text-primary);">${rel.pattern.substring(0, 80)}${rel.pattern.length > 80 ? '...' : ''}</strong>
                                    <span style="background: var(--accent-color); color: white; padding: 3px 8px; border-radius: 12px; font-size: 11px; font-weight: 600;">${rel.count} kez</span>
                                </div>
                                <div style="color: var(--text-secondary); font-size: 12px;">
                                    <span style="background: ${rel.log_level === 'ERROR' ? '#e74c3c' : '#f39c12'}; color: white; padding: 2px 6px; border-radius: 3px; font-size: 10px; font-weight: 600; margin-right: 5px;">${rel.log_level}</span>
                                    Ä°lk: ${new Date(rel.occurrences[0].timestamp).toLocaleString('tr-TR')} | Son: ${new Date(rel.occurrences[rel.occurrences.length - 1].timestamp).toLocaleString('tr-TR')}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                ` : ''}
            `;
            
            // Timeline chart oluÅŸtur
            if (timelineData.timeline_data && timelineData.timeline_data.length > 0) {
                const ctx = document.getElementById('timelineChart').getContext('2d');
                
                if (timelineChart) timelineChart.destroy();
                
                const labels = timelineData.timeline_data.map(d => new Date(d.timestamp).toLocaleString('tr-TR'));
                const errorData = timelineData.timeline_data.map(d => d.error_count || 0);
                const warningData = timelineData.timeline_data.map(d => d.warning_count || 0);
                const infoData = timelineData.timeline_data.map(d => d.info_count || 0);
                const debugData = timelineData.timeline_data.map(d => d.debug_count || 0);
                
                timelineChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [
                            {
                                label: 'Hatalar',
                                data: errorData,
                                borderColor: '#dc3545',
                                backgroundColor: 'rgba(220, 53, 69, 0.1)',
                                tension: 0.4,
                                fill: true
                            },
                            {
                                label: 'UyarÄ±lar',
                                data: warningData,
                                borderColor: '#ffc107',
                                backgroundColor: 'rgba(255, 193, 7, 0.1)',
                                tension: 0.4,
                                fill: true
                            },
                            {
                                label: 'Bilgiler',
                                data: infoData,
                                borderColor: '#28a745',
                                backgroundColor: 'rgba(40, 167, 69, 0.1)',
                                tension: 0.4,
                                fill: true
                            },
                            {
                                label: 'Debug',
                                data: debugData,
                                borderColor: '#17a2b8',
                                backgroundColor: 'rgba(23, 162, 184, 0.1)',
                                tension: 0.4,
                                fill: true
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        aspectRatio: 2.5,
                        interaction: {
                            mode: 'index',
                            intersect: false
                        },
                        plugins: {
                            title: {
                                display: false
                            },
                            legend: {
                                position: 'top',
                                labels: {
                                    color: textColor,
                                    padding: 12,
                                    font: {
                                        size: 12
                                    }
                                }
                            },
                            zoom: {
                                zoom: {
                                    wheel: {
                                        enabled: true
                                    },
                                    pinch: {
                                        enabled: true
                                    },
                                    mode: 'x'
                                },
                                pan: {
                                    enabled: true,
                                    mode: 'x'
                                }
                            }
                        },
                        scales: {
                            x: {
                                ticks: {
                                    color: textColor,
                                    maxRotation: 45,
                                    minRotation: 45
                                },
                                grid: {
                                    color: isDark ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.1)'
                                }
                            },
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    color: textColor
                                },
                                grid: {
                                    color: isDark ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.1)'
                                }
                            }
                        }
                    }
                });
            }
            
            timelineDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // ========== ADVANCED FILTERING ==========
        function showAdvancedFilterModal(fileId) {
            // GeliÅŸmiÅŸ filtreleme modalÄ±
            const modal = document.createElement('div');
            modal.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; display: flex; justify-content: center; align-items: center;';
            modal.innerHTML = `
                <div style="background: var(--card-bg); padding: 30px; border-radius: 15px; max-width: 600px; width: 90%;">
                    <h2 style="color: var(--text-primary); margin-bottom: 20px;">ğŸ” GeliÅŸmiÅŸ Filtreleme</h2>
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; color: var(--text-primary);">Arama Tipi</label>
                        <select id="filterSearchType" style="width: 100%; padding: 8px; border: 2px solid var(--border-color); border-radius: 5px; background: var(--input-bg); color: var(--text-primary);">
                            <option value="normal">Normal Arama</option>
                            <option value="regex">Regex Arama</option>
                        </select>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; color: var(--text-primary);">Arama Metni</label>
                        <input type="text" id="filterSearchText" placeholder="Arama..." style="width: 100%; padding: 8px; border: 2px solid var(--border-color); border-radius: 5px; background: var(--input-bg); color: var(--text-primary);">
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; color: var(--text-primary);">Tarih AralÄ±ÄŸÄ±</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="datetime-local" id="filterStartDate" style="flex: 1; padding: 8px; border: 2px solid var(--border-color); border-radius: 5px; background: var(--input-bg); color: var(--text-primary);">
                            <input type="datetime-local" id="filterEndDate" style="flex: 1; padding: 8px; border: 2px solid var(--border-color); border-radius: 5px; background: var(--input-bg); color: var(--text-primary);">
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px; justify-content: flex-end;">
                        <button onclick="this.closest('div[style*=\"position: fixed\"]').remove()" style="padding: 10px 20px; background: var(--bg-tertiary); color: var(--text-primary); border: none; border-radius: 5px; cursor: pointer;">Ä°ptal</button>
                        <button onclick="applyAdvancedFilter(${fileId}, this)" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer;">Uygula</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        async function applyAdvancedFilter(fileId, button) {
            const searchType = document.getElementById('filterSearchType').value;
            const searchText = document.getElementById('filterSearchText').value;
            const startDate = document.getElementById('filterStartDate').value;
            const endDate = document.getElementById('filterEndDate').value;
            
            let url = `${API_BASE}/analysis/${fileId}/entries?search_type=${searchType}`;
            if (searchText) url += `&search=${encodeURIComponent(searchText)}`;
            if (startDate) url += `&start_date=${startDate}`;
            if (endDate) url += `&end_date=${endDate}`;
            
            try {
                const response = await fetch(url);
                const entries = await response.json();
                // Filtered entries'i gÃ¶ster (modal veya yeni bir section'da)
                console.log('FiltrelenmiÅŸ giriÅŸler:', entries);
                button.closest('div[style*="position: fixed"]').remove();
                showNotification(`${entries.length} sonuÃ§ bulundu`, 'success');
            } catch (error) {
                console.error('Filtreleme hatasÄ±:', error);
            }
        }

        // ========== BULK OPERATIONS ==========
        function updateBulkActionsToolbar() {
            const checkboxes = document.querySelectorAll('.file-checkbox:checked');
            const toolbar = document.getElementById('bulkActionsToolbar');
            const countSpan = document.getElementById('selectedCount');
            
            if (checkboxes.length > 0) {
                toolbar.style.display = 'block';
                countSpan.textContent = checkboxes.length;
            } else {
                toolbar.style.display = 'none';
            }
        }

        function selectAllFiles() {
            document.querySelectorAll('.file-checkbox').forEach(cb => cb.checked = true);
            updateBulkActionsToolbar();
        }

        function deselectAllFiles() {
            document.querySelectorAll('.file-checkbox').forEach(cb => cb.checked = false);
            updateBulkActionsToolbar();
        }

        function getSelectedFileIds() {
            return Array.from(document.querySelectorAll('.file-checkbox:checked')).map(cb => parseInt(cb.dataset.fileId));
        }

        async function bulkDeleteFiles() {
            const fileIds = getSelectedFileIds();
            if (fileIds.length === 0) {
                showNotification('LÃ¼tfen en az bir dosya seÃ§in!', 'error');
                return;
            }
            
            if (!confirm(`${fileIds.length} dosyayÄ± silmek istediÄŸinizden emin misiniz?`)) {
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/logs/bulk-delete`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ file_ids: fileIds })
                });
                
                if (response.ok) {
                    const result = await response.json();
                    showNotification(`${result.deleted_count} dosya silindi`, 'success');
                    deselectAllFiles();
                    loadFiles();
                    loadDashboard();
                    loadFavorites();
                } else {
                    throw new Error('Toplu silme hatasÄ±');
                }
            } catch (error) {
                console.error('Toplu silme hatasÄ±:', error);
                showNotification('Toplu silme yapÄ±lÄ±rken hata oluÅŸtu!', 'error');
            }
        }

        async function bulkExportFiles() {
            const fileIds = getSelectedFileIds();
            if (fileIds.length === 0) {
                showNotification('LÃ¼tfen en az bir dosya seÃ§in!', 'error');
                return;
            }
            
            const format = prompt('Export formatÄ± seÃ§in (json/xml):', 'json');
            if (!format || !['json', 'xml'].includes(format.toLowerCase())) {
                showNotification('GeÃ§ersiz format!', 'error');
                return;
            }
            
            const includeAnalysis = confirm('Analiz sonuÃ§larÄ±nÄ± da dahil etmek ister misiniz?');
            
            try {
                const response = await fetch(`${API_BASE}/logs/bulk-export`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        file_ids: fileIds,
                        format: format.toLowerCase(),
                        include_analysis: includeAnalysis
                    })
                });
                
                if (response.ok) {
                    const blob = await response.blob();
                    const downloadUrl = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = downloadUrl;
                    a.download = `bulk_export_${new Date().toISOString().split('T')[0]}.zip`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    window.URL.revokeObjectURL(downloadUrl);
                    showNotification('Toplu export baÅŸarÄ±lÄ±!', 'success');
                    deselectAllFiles();
                } else {
                    throw new Error('Toplu export hatasÄ±');
                }
            } catch (error) {
                console.error('Toplu export hatasÄ±:', error);
                showNotification('Toplu export yapÄ±lÄ±rken hata oluÅŸtu!', 'error');
            }
        }

        async function bulkFavoriteFiles(action) {
            const fileIds = getSelectedFileIds();
            if (fileIds.length === 0) {
                showNotification('LÃ¼tfen en az bir dosya seÃ§in!', 'error');
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/logs/bulk-favorite`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        file_ids: fileIds,
                        action: action
                    })
                });
                
                if (response.ok) {
                    const result = await response.json();
                    showNotification(`${result.processed_count} dosya iÅŸlendi`, 'success');
                    deselectAllFiles();
                    loadFiles();
                    loadFavorites();
                } else {
                    throw new Error('Toplu favori iÅŸlemi hatasÄ±');
                }
            } catch (error) {
                console.error('Toplu favori iÅŸlemi hatasÄ±:', error);
                showNotification('Toplu favori iÅŸlemi yapÄ±lÄ±rken hata oluÅŸtu!', 'error');
            }
        }

        // ========== TAGS & CATEGORIES ==========
        async function loadTagsForFilter() {
            try {
                const response = await fetch(`${API_BASE}/tags/`);
                if (!response.ok) return;
                
                const tags = await response.json();
                const select = document.getElementById('tagFilter');
                const currentValue = select.value;
                
                select.innerHTML = '<option value="">TÃ¼m Etiketler</option>';
                tags.forEach(tag => {
                    const option = document.createElement('option');
                    option.value = tag.name;
                    option.textContent = tag.name;
                    select.appendChild(option);
                });
                
                if (currentValue) select.value = currentValue;
            } catch (error) {
                console.error('Tag yÃ¼kleme hatasÄ±:', error);
            }
        }

        async function loadCategoriesForFilter() {
            try {
                const response = await fetch(`${API_BASE}/tags/categories/`);
                if (!response.ok) return;
                
                const categories = await response.json();
                const select = document.getElementById('categoryFilter');
                const currentValue = select.value;
                
                select.innerHTML = '<option value="">TÃ¼m Kategoriler</option>';
                categories.forEach(cat => {
                    const option = document.createElement('option');
                    option.value = cat.id;
                    option.textContent = `${cat.icon || 'ğŸ“'} ${cat.name}`;
                    select.appendChild(option);
                });
                
                if (currentValue) select.value = currentValue;
            } catch (error) {
                console.error('Kategori yÃ¼kleme hatasÄ±:', error);
            }
        }

        function filterByTag(tagName) {
            document.getElementById('tagFilter').value = tagName;
            loadFiles();
        }

        async function showFileTagsModal(fileId) {
            // Tag yÃ¶netimi modalÄ± gÃ¶ster
            const modal = document.createElement('div');
            modal.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 10010; display: flex; justify-content: center; align-items: center; backdrop-filter: blur(5px);';
            modal.onclick = function(e) {
                if (e.target === modal) modal.remove();
            };
            
            try {
                const [fileRes, tagsRes] = await Promise.all([
                    fetch(`${API_BASE}/logs/${fileId}`),
                    fetch(`${API_BASE}/tags/`)
                ]);
                
                const file = await fileRes.json();
                const allTags = await tagsRes.json();
                const fileTags = file.tags || [];
                const fileTagIds = new Set(fileTags.map(t => t.id));
                
                modal.innerHTML = `
                    <div style="background: var(--card-bg); padding: 25px; border-radius: 15px; max-width: 600px; width: 90%; max-height: 80vh; overflow-y: auto; box-shadow: 0 10px 40px var(--shadow);" onclick="event.stopPropagation();">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 2px solid var(--bg-tertiary); padding-bottom: 15px;">
                            <h2 style="color: var(--text-primary); margin: 0;">ğŸ·ï¸ Etiket YÃ¶netimi</h2>
                            <button onclick="this.closest('div[style*=\"position: fixed\"]').remove()" style="background: transparent; border: none; font-size: 24px; cursor: pointer; color: var(--text-secondary);">âœ•</button>
                        </div>
                        <p style="color: var(--text-secondary); margin-bottom: 20px;">Dosya: <strong>${file.filename}</strong></p>
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 8px; color: var(--text-primary); font-weight: 600;">Etiketler:</label>
                            <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 15px;">
                                ${allTags.map(tag => `
                                    <label style="display: flex; align-items: center; gap: 8px; padding: 8px 12px; background: ${fileTagIds.has(tag.id) ? tag.color || '#667eea' : 'var(--bg-tertiary)'}; color: ${fileTagIds.has(tag.id) ? 'white' : 'var(--text-primary)'}; border-radius: 8px; cursor: pointer; border: 2px solid ${fileTagIds.has(tag.id) ? tag.color || '#667eea' : 'transparent'}; transition: all 0.2s;">
                                        <input type="checkbox" ${fileTagIds.has(tag.id) ? 'checked' : ''} data-tag-id="${tag.id}" style="width: 16px; height: 16px; cursor: pointer;">
                                        <span>${tag.name}</span>
                                    </label>
                                `).join('')}
                            </div>
                        </div>
                        <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 25px; padding-top: 20px; border-top: 2px solid var(--bg-tertiary);">
                            <button onclick="this.closest('div[style*=\"position: fixed\"]').remove()" style="padding: 10px 20px; background: var(--bg-tertiary); color: var(--text-primary); border: none; border-radius: 6px; cursor: pointer;">Ä°ptal</button>
                            <button onclick="saveFileTags(${fileId}, this)" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 500;">Kaydet</button>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
            } catch (error) {
                console.error('Tag modal yÃ¼kleme hatasÄ±:', error);
                showNotification('Etiket bilgileri yÃ¼klenirken hata oluÅŸtu!', 'error');
            }
        }

        async function saveFileTags(fileId, button) {
            const checkboxes = button.closest('div[style*="position: fixed"]').querySelectorAll('input[type="checkbox"]:checked');
            const tagIds = Array.from(checkboxes).map(cb => parseInt(cb.dataset.tagId));
            
            try {
                const response = await fetch(`${API_BASE}/tags/files/${fileId}/bulk`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ tag_ids: tagIds })
                });
                
                if (response.ok) {
                    showNotification('Etiketler gÃ¼ncellendi!', 'success');
                    button.closest('div[style*="position: fixed"]').remove();
                    loadFiles();
                } else {
                    throw new Error('Etiket gÃ¼ncelleme hatasÄ±');
                }
            } catch (error) {
                console.error('Etiket kaydetme hatasÄ±:', error);
                showNotification('Etiketler kaydedilirken hata oluÅŸtu!', 'error');
            }
        }

        async function showTagManagementModal() {
            const modal = document.createElement('div');
            modal.id = 'tagManagementModal';
            modal.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 10011; display: flex; justify-content: center; align-items: center; backdrop-filter: blur(5px); overflow-y: auto; padding: 20px;';
            modal.onclick = function(e) {
                if (e.target === modal) closeTagManagementModal();
            };
            
            try {
                const tagsRes = await fetch(`${API_BASE}/tags/`);
                const tags = tagsRes.ok ? await tagsRes.json() : [];
                
                const modalContent = document.createElement('div');
                modalContent.style.cssText = 'background: var(--card-bg); padding: 25px; border-radius: 15px; max-width: 700px; width: 90%; max-height: 80vh; overflow-y: auto; box-shadow: 0 10px 40px var(--shadow);';
                modalContent.onclick = function(e) { e.stopPropagation(); };
                
                const closeBtn = document.createElement('button');
                closeBtn.textContent = 'âœ•';
                closeBtn.style.cssText = 'background: transparent; border: none; font-size: 24px; cursor: pointer; color: var(--text-secondary);';
                closeBtn.onclick = () => closeTagManagementModal();
                
                const header = document.createElement('div');
                header.style.cssText = 'display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 2px solid var(--bg-tertiary); padding-bottom: 15px;';
                header.innerHTML = '<h2 style="color: var(--text-primary); margin: 0;">ğŸ·ï¸ Etiket YÃ¶netimi</h2>';
                header.appendChild(closeBtn);
                
                const createBtn = document.createElement('button');
                createBtn.textContent = '+ Yeni Etiket';
                createBtn.style.cssText = 'padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 500; margin-bottom: 15px;';
                createBtn.onclick = () => showCreateTagModal();
                
                const tagsList = document.createElement('div');
                tagsList.style.cssText = 'display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px;';
                
                tags.forEach(tag => {
                    const tagDiv = document.createElement('div');
                    tagDiv.style.cssText = `background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 4px solid ${tag.color || '#667eea'};`;
                    
                    const deleteBtn = document.createElement('button');
                    deleteBtn.textContent = 'ğŸ—‘ï¸';
                    deleteBtn.style.cssText = 'background: transparent; border: none; color: var(--error-text); cursor: pointer; font-size: 16px; padding: 2px 6px;';
                    deleteBtn.onclick = () => deleteTag(tag.id);
                    
                    const editBtn = document.createElement('button');
                    editBtn.textContent = 'DÃ¼zenle';
                    editBtn.style.cssText = 'width: 100%; padding: 6px; background: var(--border-color); color: var(--text-primary); border: none; border-radius: 4px; cursor: pointer; font-size: 11px; margin-top: 8px;';
                    editBtn.onclick = () => editTag(tag.id);
                    
                    tagDiv.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px;">
                            <span style="background: ${tag.color || '#667eea'}; color: white; padding: 4px 10px; border-radius: 12px; font-size: 12px; font-weight: 600;">${tag.name}</span>
                        </div>
                        ${tag.description ? `<p style="color: var(--text-secondary); font-size: 11px; margin: 5px 0;">${tag.description}</p>` : ''}
                    `;
                    tagDiv.querySelector('div').appendChild(deleteBtn);
                    tagDiv.appendChild(editBtn);
                    tagsList.appendChild(tagDiv);
                });
                
                modalContent.appendChild(header);
                modalContent.appendChild(createBtn);
                modalContent.appendChild(tagsList);
                modal.appendChild(modalContent);
                document.body.appendChild(modal);
            } catch (error) {
                console.error('Tag yÃ¶netimi modal hatasÄ±:', error);
                showNotification('Etiket yÃ¶netimi yÃ¼klenirken hata oluÅŸtu!', 'error');
            }
        }

        function closeTagManagementModal() {
            const modal = document.getElementById('tagManagementModal');
            if (modal) modal.remove();
        }

        function showCreateTagModal() {
            const name = prompt('Etiket adÄ±:');
            if (!name) return;
            
            const color = prompt('Renk (hex, Ã¶rn: #667eea):', '#667eea');
            const description = prompt('AÃ§Ä±klama (opsiyonel):') || '';
            
            createTag({ name, color: color || '#667eea', description });
        }

        async function createTag(tagData) {
            try {
                const response = await fetch(`${API_BASE}/tags/`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(tagData)
                });
                
                if (response.ok) {
                    showNotification('Etiket oluÅŸturuldu!', 'success');
                    loadTagsForFilter();
                    closeTagManagementModal();
                    setTimeout(() => showTagManagementModal(), 100);
                } else {
                    throw new Error('Etiket oluÅŸturma hatasÄ±');
                }
            } catch (error) {
                console.error('Etiket oluÅŸturma hatasÄ±:', error);
                showNotification('Etiket oluÅŸturulurken hata oluÅŸtu!', 'error');
            }
        }

        async function deleteTag(tagId) {
            if (!confirm('Bu etiketi silmek istediÄŸinizden emin misiniz?')) return;
            
            try {
                const response = await fetch(`${API_BASE}/tags/${tagId}`, { method: 'DELETE' });
                if (response.ok) {
                    showNotification('Etiket silindi!', 'success');
                    loadTagsForFilter();
                    closeTagManagementModal();
                    setTimeout(() => showTagManagementModal(), 100);
                } else {
                    throw new Error('Etiket silme hatasÄ±');
                }
            } catch (error) {
                console.error('Etiket silme hatasÄ±:', error);
                showNotification('Etiket silinirken hata oluÅŸtu!', 'error');
            }
        }

        function editTag(tagId) {
            const name = prompt('Yeni etiket adÄ±:');
            if (!name) return;
            
            const color = prompt('Yeni renk (hex):', '#667eea');
            const description = prompt('Yeni aÃ§Ä±klama:') || '';
            
            updateTag(tagId, { name, color: color || '#667eea', description });
        }

        async function updateTag(tagId, tagData) {
            try {
                const response = await fetch(`${API_BASE}/tags/${tagId}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(tagData)
                });
                
                if (response.ok) {
                    showNotification('Etiket gÃ¼ncellendi!', 'success');
                    loadTagsForFilter();
                    closeTagManagementModal();
                    setTimeout(() => showTagManagementModal(), 100);
                } else {
                    throw new Error('Etiket gÃ¼ncelleme hatasÄ±');
                }
            } catch (error) {
                console.error('Etiket gÃ¼ncelleme hatasÄ±:', error);
                showNotification('Etiket gÃ¼ncellenirken hata oluÅŸtu!', 'error');
            }
        }

        async function showCategoryManagementModal() {
            const modal = document.createElement('div');
            modal.id = 'categoryManagementModal';
            modal.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 10012; display: flex; justify-content: center; align-items: center; backdrop-filter: blur(5px); overflow-y: auto; padding: 20px;';
            modal.onclick = function(e) {
                if (e.target === modal) closeCategoryManagementModal();
            };
            
            try {
                const categoriesRes = await fetch(`${API_BASE}/tags/categories/`);
                const categories = categoriesRes.ok ? await categoriesRes.json() : [];
                
                const modalContent = document.createElement('div');
                modalContent.style.cssText = 'background: var(--card-bg); padding: 25px; border-radius: 15px; max-width: 700px; width: 90%; max-height: 80vh; overflow-y: auto; box-shadow: 0 10px 40px var(--shadow);';
                modalContent.onclick = function(e) { e.stopPropagation(); };
                
                const closeBtn = document.createElement('button');
                closeBtn.textContent = 'âœ•';
                closeBtn.style.cssText = 'background: transparent; border: none; font-size: 24px; cursor: pointer; color: var(--text-secondary);';
                closeBtn.onclick = () => closeCategoryManagementModal();
                
                const header = document.createElement('div');
                header.style.cssText = 'display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 2px solid var(--bg-tertiary); padding-bottom: 15px;';
                header.innerHTML = '<h2 style="color: var(--text-primary); margin: 0;">ğŸ“ Kategori YÃ¶netimi</h2>';
                header.appendChild(closeBtn);
                
                const createBtn = document.createElement('button');
                createBtn.textContent = '+ Yeni Kategori';
                createBtn.style.cssText = 'padding: 10px 20px; background: #17a2b8; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 500; margin-bottom: 15px;';
                createBtn.onclick = () => showCreateCategoryModal();
                
                const categoriesList = document.createElement('div');
                categoriesList.style.cssText = 'display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px;';
                
                categories.forEach(cat => {
                    const catDiv = document.createElement('div');
                    catDiv.style.cssText = `background: var(--bg-tertiary); padding: 12px; border-radius: 8px; border-left: 4px solid ${cat.color || '#17a2b8'};`;
                    
                    const deleteBtn = document.createElement('button');
                    deleteBtn.textContent = 'ğŸ—‘ï¸';
                    deleteBtn.style.cssText = 'background: transparent; border: none; color: var(--error-text); cursor: pointer; font-size: 16px; padding: 2px 6px;';
                    deleteBtn.onclick = () => deleteCategory(cat.id);
                    
                    const editBtn = document.createElement('button');
                    editBtn.textContent = 'DÃ¼zenle';
                    editBtn.style.cssText = 'width: 100%; padding: 6px; background: var(--border-color); color: var(--text-primary); border: none; border-radius: 4px; cursor: pointer; font-size: 11px; margin-top: 8px;';
                    editBtn.onclick = () => editCategory(cat.id);
                    
                    catDiv.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px;">
                            <span style="background: ${cat.color || '#17a2b8'}; color: white; padding: 4px 10px; border-radius: 12px; font-size: 12px; font-weight: 600;">${cat.icon || 'ğŸ“'} ${cat.name}</span>
                        </div>
                        ${cat.description ? `<p style="color: var(--text-secondary); font-size: 11px; margin: 5px 0;">${cat.description}</p>` : ''}
                    `;
                    catDiv.querySelector('div').appendChild(deleteBtn);
                    catDiv.appendChild(editBtn);
                    categoriesList.appendChild(catDiv);
                });
                
                modalContent.appendChild(header);
                modalContent.appendChild(createBtn);
                modalContent.appendChild(categoriesList);
                modal.appendChild(modalContent);
                document.body.appendChild(modal);
            } catch (error) {
                console.error('Kategori yÃ¶netimi modal hatasÄ±:', error);
                showNotification('Kategori yÃ¶netimi yÃ¼klenirken hata oluÅŸtu!', 'error');
            }
        }

        function closeCategoryManagementModal() {
            const modal = document.getElementById('categoryManagementModal');
            if (modal) modal.remove();
        }

        function showCreateCategoryModal() {
            const name = prompt('Kategori adÄ±:');
            if (!name) return;
            
            const icon = prompt('Icon (emoji, Ã¶rn: ğŸ“):', 'ğŸ“');
            const color = prompt('Renk (hex, Ã¶rn: #17a2b8):', '#17a2b8');
            const description = prompt('AÃ§Ä±klama (opsiyonel):') || '';
            
            createCategory({ name, icon: icon || 'ğŸ“', color: color || '#17a2b8', description });
        }

        async function createCategory(categoryData) {
            try {
                const response = await fetch(`${API_BASE}/tags/categories/`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(categoryData)
                });
                
                if (response.ok) {
                    showNotification('Kategori oluÅŸturuldu!', 'success');
                    loadCategoriesForFilter();
                    closeCategoryManagementModal();
                    setTimeout(() => showCategoryManagementModal(), 100);
                } else {
                    throw new Error('Kategori oluÅŸturma hatasÄ±');
                }
            } catch (error) {
                console.error('Kategori oluÅŸturma hatasÄ±:', error);
                showNotification('Kategori oluÅŸturulurken hata oluÅŸtu!', 'error');
            }
        }

        async function deleteCategory(categoryId) {
            if (!confirm('Bu kategoriyi silmek istediÄŸinizden emin misiniz? Kategorideki dosyalarÄ±n kategorisi kaldÄ±rÄ±lacak.')) return;
            
            try {
                const response = await fetch(`${API_BASE}/tags/categories/${categoryId}`, { method: 'DELETE' });
                if (response.ok) {
                    showNotification('Kategori silindi!', 'success');
                    loadCategoriesForFilter();
                    closeCategoryManagementModal();
                    setTimeout(() => showCategoryManagementModal(), 100);
                } else {
                    throw new Error('Kategori silme hatasÄ±');
                }
            } catch (error) {
                console.error('Kategori silme hatasÄ±:', error);
                showNotification('Kategori silinirken hata oluÅŸtu!', 'error');
            }
        }

        function editCategory(categoryId) {
            const name = prompt('Yeni kategori adÄ±:');
            if (!name) return;
            
            const icon = prompt('Yeni icon (emoji):', 'ğŸ“');
            const color = prompt('Yeni renk (hex):', '#17a2b8');
            const description = prompt('Yeni aÃ§Ä±klama:') || '';
            
            updateCategory(categoryId, { name, icon: icon || 'ğŸ“', color: color || '#17a2b8', description });
        }

        async function updateCategory(categoryId, categoryData) {
            try {
                const response = await fetch(`${API_BASE}/tags/categories/${categoryId}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(categoryData)
                });
                
                if (response.ok) {
                    showNotification('Kategori gÃ¼ncellendi!', 'success');
                    loadCategoriesForFilter();
                    closeCategoryManagementModal();
                    setTimeout(() => showCategoryManagementModal(), 100);
                } else {
                    throw new Error('Kategori gÃ¼ncelleme hatasÄ±');
                }
            } catch (error) {
                console.error('Kategori gÃ¼ncelleme hatasÄ±:', error);
                showNotification('Kategori gÃ¼ncellenirken hata oluÅŸtu!', 'error');
            }
        }

        async function showFileCategoryModal(fileId) {
            const modal = document.createElement('div');
            modal.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 10013; display: flex; justify-content: center; align-items: center; backdrop-filter: blur(5px);';
            modal.onclick = function(e) {
                if (e.target === modal) modal.remove();
            };
            
            try {
                const [fileRes, categoriesRes] = await Promise.all([
                    fetch(`${API_BASE}/logs/${fileId}`),
                    fetch(`${API_BASE}/tags/categories/`)
                ]);
                
                const file = await fileRes.json();
                const categories = categoriesRes.ok ? await categoriesRes.json() : [];
                const currentCategoryId = file.category ? file.category.id : null;
                
                modal.innerHTML = `
                    <div style="background: var(--card-bg); padding: 25px; border-radius: 15px; max-width: 500px; width: 90%; box-shadow: 0 10px 40px var(--shadow);" onclick="event.stopPropagation();">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 2px solid var(--bg-tertiary); padding-bottom: 15px;">
                            <h2 style="color: var(--text-primary); margin: 0;">ğŸ“ Kategori Ata</h2>
                            <button onclick="this.closest('div[style*=\"position: fixed\"]').remove()" style="background: transparent; border: none; font-size: 24px; cursor: pointer; color: var(--text-secondary);">âœ•</button>
                        </div>
                        <p style="color: var(--text-secondary); margin-bottom: 20px;">Dosya: <strong>${file.filename}</strong></p>
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 8px; color: var(--text-primary); font-weight: 600;">Kategori:</label>
                            <select id="fileCategorySelect" style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; background: var(--input-bg); color: var(--text-primary); font-size: 14px;">
                                <option value="">Kategori Yok</option>
                                ${categories.map(cat => `
                                    <option value="${cat.id}" ${currentCategoryId === cat.id ? 'selected' : ''}>${cat.icon || 'ğŸ“'} ${cat.name}</option>
                                `).join('')}
                            </select>
                        </div>
                        <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 25px; padding-top: 20px; border-top: 2px solid var(--bg-tertiary);">
                            <button onclick="this.closest('div[style*=\"position: fixed\"]').remove()" style="padding: 10px 20px; background: var(--bg-tertiary); color: var(--text-primary); border: none; border-radius: 6px; cursor: pointer;">Ä°ptal</button>
                            <button onclick="saveFileCategory(${fileId}, this)" style="padding: 10px 20px; background: #17a2b8; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 500;">Kaydet</button>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
            } catch (error) {
                console.error('Kategori modal yÃ¼kleme hatasÄ±:', error);
                showNotification('Kategori bilgileri yÃ¼klenirken hata oluÅŸtu!', 'error');
            }
        }

        async function saveFileCategory(fileId, button) {
            const categorySelect = button.closest('div[style*="position: fixed"]').querySelector('#fileCategorySelect');
            const categoryId = categorySelect.value ? parseInt(categorySelect.value) : null;
            
            try {
                const response = await fetch(`${API_BASE}/tags/files/${fileId}/category?category_id=${categoryId || ''}`, {
                    method: 'PUT'
                });
                
                if (response.ok) {
                    showNotification('Kategori gÃ¼ncellendi!', 'success');
                    button.closest('div[style*="position: fixed"]').remove();
                    loadFiles();
                } else {
                    throw new Error('Kategori gÃ¼ncelleme hatasÄ±');
                }
            } catch (error) {
                console.error('Kategori kaydetme hatasÄ±:', error);
                showNotification('Kategori kaydedilirken hata oluÅŸtu!', 'error');
            }
        }

        // ========== AUTHENTICATION ==========
        let currentUser = null;

        // Token yÃ¶netimi
        function getAuthToken() {
            return localStorage.getItem('auth_token');
        }

        function setAuthToken(token) {
            localStorage.setItem('auth_token', token);
        }

        function removeAuthToken() {
            localStorage.removeItem('auth_token');
        }

        // API isteklerinde token ekle
        function getAuthHeaders() {
            const token = getAuthToken();
            const headers = { 'Content-Type': 'application/json' };
            if (token) {
                headers['Authorization'] = `Bearer ${token}`;
            }
            return headers;
        }

        // Login
        function showLoginModal() {
            document.getElementById('loginModal').style.display = 'flex';
            document.getElementById('loginError').style.display = 'none';
            document.getElementById('loginUsername').value = '';
            document.getElementById('loginPassword').value = '';
        }

        function closeLoginModal() {
            document.getElementById('loginModal').style.display = 'none';
        }

        async function submitLogin() {
            const username = document.getElementById('loginUsername').value.trim();
            const password = document.getElementById('loginPassword').value;
            const errorDiv = document.getElementById('loginError');

            if (!username || !password) {
                errorDiv.textContent = 'LÃ¼tfen kullanÄ±cÄ± adÄ± ve ÅŸifre girin!';
                errorDiv.style.display = 'block';
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/auth/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });

                const data = await response.json();

                if (response.ok) {
                    setAuthToken(data.access_token);
                    await loadCurrentUser();
                    closeLoginModal();
                    showNotification('GiriÅŸ baÅŸarÄ±lÄ±!', 'success');
                    updateAuthUI();
                } else {
                    errorDiv.textContent = data.detail || 'GiriÅŸ baÅŸarÄ±sÄ±z!';
                    errorDiv.style.display = 'block';
                }
            } catch (error) {
                console.error('Login hatasÄ±:', error);
                errorDiv.textContent = 'GiriÅŸ yapÄ±lÄ±rken hata oluÅŸtu!';
                errorDiv.style.display = 'block';
            }
        }

        // Register
        function showRegisterModal() {
            document.getElementById('registerModal').style.display = 'flex';
            document.getElementById('registerError').style.display = 'none';
            document.getElementById('registerUsername').value = '';
            document.getElementById('registerEmail').value = '';
            document.getElementById('registerFullName').value = '';
            document.getElementById('registerPassword').value = '';
        }

        function closeRegisterModal() {
            document.getElementById('registerModal').style.display = 'none';
        }

        async function submitRegister() {
            const username = document.getElementById('registerUsername').value.trim();
            const email = document.getElementById('registerEmail').value.trim();
            const fullName = document.getElementById('registerFullName').value.trim();
            const password = document.getElementById('registerPassword').value;
            const errorDiv = document.getElementById('registerError');

            if (!username || !email || !password) {
                errorDiv.textContent = 'LÃ¼tfen zorunlu alanlarÄ± doldurun!';
                errorDiv.style.display = 'block';
                return;
            }

            if (password.length < 6) {
                errorDiv.textContent = 'Åifre en az 6 karakter olmalÄ±dÄ±r!';
                errorDiv.style.display = 'block';
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/auth/register`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        username,
                        email,
                        full_name: fullName || null,
                        password
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    closeRegisterModal();
                    showNotification('KayÄ±t baÅŸarÄ±lÄ±! GiriÅŸ yapabilirsiniz.', 'success');
                    setTimeout(() => showLoginModal(), 500);
                } else {
                    errorDiv.textContent = data.detail || 'KayÄ±t baÅŸarÄ±sÄ±z!';
                    errorDiv.style.display = 'block';
                }
            } catch (error) {
                console.error('Register hatasÄ±:', error);
                errorDiv.textContent = 'KayÄ±t olurken hata oluÅŸtu!';
                errorDiv.style.display = 'block';
            }
        }

        // Logout
        async function logout() {
            removeAuthToken();
            currentUser = null;
            updateAuthUI();
            showNotification('Ã‡Ä±kÄ±ÅŸ yapÄ±ldÄ±', 'success');
        }

        // Current user yÃ¼kle
        async function loadCurrentUser() {
            const token = getAuthToken();
            if (!token) {
                currentUser = null;
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/auth/me`, {
                    headers: getAuthHeaders()
                });

                if (response.ok) {
                    currentUser = await response.json();
                } else {
                    // Token geÃ§ersiz
                    removeAuthToken();
                    currentUser = null;
                }
            } catch (error) {
                console.error('User yÃ¼kleme hatasÄ±:', error);
                currentUser = null;
            }
        }

        // Auth UI gÃ¼ncelle
        function updateAuthUI() {
            const authButtons = document.getElementById('authButtons');
            const userInfo = document.getElementById('userInfo');
            const userName = document.getElementById('userName');

            if (currentUser) {
                authButtons.style.display = 'none';
                userInfo.style.display = 'flex';
                userName.textContent = currentUser.full_name || currentUser.username;
            } else {
                authButtons.style.display = 'flex';
                userInfo.style.display = 'none';
            }
        }

        // Profile
        function showProfileModal() {
            const modal = document.getElementById('profileModal');
            const content = document.getElementById('profileContent');

            if (!currentUser) {
                showNotification('LÃ¼tfen Ã¶nce giriÅŸ yapÄ±n!', 'error');
                return;
            }

            content.innerHTML = `
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; color: var(--text-secondary); font-size: 12px;">KullanÄ±cÄ± AdÄ±</label>
                    <div style="padding: 10px; background: var(--bg-tertiary); border-radius: 6px; color: var(--text-primary);">${currentUser.username}</div>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; color: var(--text-secondary); font-size: 12px;">Email</label>
                    <div style="padding: 10px; background: var(--bg-tertiary); border-radius: 6px; color: var(--text-primary);">${currentUser.email}</div>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; color: var(--text-secondary); font-size: 12px;">Ad Soyad</label>
                    <div style="padding: 10px; background: var(--bg-tertiary); border-radius: 6px; color: var(--text-primary);">${currentUser.full_name || '-'}</div>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; color: var(--text-secondary); font-size: 12px;">Rol</label>
                    <div style="padding: 10px; background: var(--bg-tertiary); border-radius: 6px; color: var(--text-primary);">${currentUser.role}</div>
                </div>
                <div style="margin-top: 20px; padding-top: 15px; border-top: 2px solid var(--bg-tertiary);">
                    <button onclick="logout(); closeProfileModal();" style="width: 100%; padding: 12px; background: #dc3545; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 500;">ğŸšª Ã‡Ä±kÄ±ÅŸ Yap</button>
                </div>
            `;

            modal.style.display = 'flex';
        }

        function closeProfileModal() {
            document.getElementById('profileModal').style.display = 'none';
        }

        // Sayfa yÃ¼klendiÄŸinde auth kontrolÃ¼ (window.onload'tan Ã¶nce Ã§alÄ±ÅŸsÄ±n)
        document.addEventListener('DOMContentLoaded', async function() {
            // Modal'larÄ± kapalÄ± tut
            document.getElementById('loginModal').style.display = 'none';
            document.getElementById('registerModal').style.display = 'none';
            document.getElementById('profileModal').style.display = 'none';
            
            await loadCurrentUser();
            updateAuthUI();
        });
    </script>
</body>
</html>


